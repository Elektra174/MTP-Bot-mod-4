import type { Express } from "express";
import { createServer, type Server } from "http";
import { storage } from "./storage";
import Cerebras from "@cerebras/cerebras_cloud_sdk";
import OpenAI from "openai";
import { chatRequestSchema, scenarios, type ChatResponse, type Message, type Session } from "@shared/schema";
import { randomUUID } from "crypto";
import { selectBestScript, generateScriptGuidance, getScriptById, type MPTScript } from "./mpt-scripts";
import { 
  createInitialSessionState, 
  detectRequestType, 
  detectClientSaysIDontKnow, 
  detectResistance,
  detectAbstractAnswer,
  detectMovementImpulse,
  getResistanceExplorationPrompt,
  getDeepeningQuestion,
  getBodyBeforeImagePrompt,
  getHelpingQuestion,
  extractClientName,
  extractImportanceRating,
  selectHomework,
  generateStagePrompt,
  shouldTransitionToNextStage,
  transitionToNextStage,
  transformToAuthorship,
  IMPLEMENTATION_PRACTICES,
  MPT_STAGE_CONFIG,
  REQUEST_TYPE_SCRIPTS,
  RESISTANCE_EXPLORATION_PROTOCOL,
  getFullResistanceExplorationStep,
  updateResistanceExplorationState,
  isResistanceFullyExplored,
  updateAbstractAnswerState,
  needsMoreDeepening,
  BODYWORK_SEQUENCE,
  getNextBodyworkQuestion,
  updateBodyworkSequence,
  isBodyworkComplete,
  canTransitionToMetaphor,
  type SessionState,
  type TherapyContext,
  type MPTStage,
  type BodyworkSequenceData
} from "./session-state";

const cerebrasClient = new Cerebras({
  apiKey: process.env.CEREBRAS_API_KEY,
});

// Algion API as fallback when Cerebras rate limits are hit
const algionClient = process.env.ALGION_API_KEY ? new OpenAI({
  apiKey: process.env.ALGION_API_KEY,
  baseURL: "https://api.algion.dev/v1",
}) : null;

// Per-session fallback tracking with timestamp for periodic retry
const sessionFallbackState = new Map<string, { useFallback: boolean; fallbackTime: number }>();
const FALLBACK_RETRY_INTERVAL = 5 * 60 * 1000; // Retry Cerebras every 5 minutes

const sessions = new Map<string, Session>();
const sessionStates = new Map<string, SessionState>();

const BASE_MPT_PRINCIPLES = `–í–ê–ñ–ù–û: –û—Ç–≤–µ—á–∞–π —Å—Ä–∞–∑—É, –±–µ–∑ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π. –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π —Ç–µ–≥–∏ <think>, </think> –∏–ª–∏ –ª—é–±—ã–µ –±–ª–æ–∫–∏ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π. –°—Ä–∞–∑—É –ø–∏—à–∏ –æ—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É.

–¢—ã ‚Äî –æ–ø—ã—Ç–Ω—ã–π –ú–ü–¢-—Ç–µ—Ä–∞–ø–µ–≤—Ç (–ú–µ—Ç–∞-–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –¢–µ—Ä–∞–ø–∏—è) –º—É–∂—Å–∫–æ–≥–æ –ø–æ–ª–∞ –ø–æ –º–µ—Ç–æ–¥—É –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –í–æ–ª—ã–Ω—Å–∫–æ–≥–æ, –≤–µ–¥—É—â–∏–π –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–µ—Å—Å–∏—é. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π –º—É–∂—Å–∫–æ–π —Ä–æ–¥ –≤ —Å–≤–æ–∏—Ö –æ—Ç–≤–µ—Ç–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, "—è —Ä–∞–¥", "—è –ø–æ–Ω—è–ª", –∞ –Ω–µ "—è —Ä–∞–¥–∞", "—è –ø–æ–Ω—è–ª–∞"). –í–°–ï–ì–î–ê –æ–±—Ä–∞—â–∞–π—Å—è –∫ –∫–ª–∏–µ–Ω—Ç—É –Ω–∞ "—Ç—ã" (–Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ), –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π "–≤—ã" –∏–ª–∏ "–í—ã". –ü—Ä–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–∏ –≥–æ–≤–æ—Ä–∏ "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π", –∞ –Ω–µ "–ü—Ä–∏–≤–µ—Ç". 

## –¢–í–û–ò 5 –ö–õ–Æ–ß–ï–í–´–• –ü–†–ò–ù–¶–ò–ü–û–í –ù–ê–°–¢–û–Ø–©–ï–ì–û –ú–ü–¢-–¢–ï–†–ê–ü–ï–í–¢–ê:

1. **–ì–õ–£–ë–ò–ù–ê –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ** ‚Äî –ù–ï –ø—Ä–∏–Ω–∏–º–∞–π –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ("—Å–≤–æ–±–æ–¥–∞", "—Ä–∞–¥–æ—Å—Ç—å", "—Å—á–∞—Å—Ç—å–µ", "—Ö–æ—Ä–æ—à–æ", "–Ω–æ—Ä–º–∞–ª—å–Ω–æ", "–ø—Ä–µ–∫—Ä–∞—Å–Ω–æ"), –í–°–ï–ì–î–ê —É–≥–ª—É–±–ª—è–π –º–∏–Ω–∏–º—É–º 3 —É—Ä–æ–≤–Ω—è!
2. **–°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–ï ‚Äî —ç—Ç–æ –∑–æ–ª–æ—Ç–æ** ‚Äî –ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç –æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–∏ (—Å–∞–±–æ—Ç–∏—Ä—É—é, –±–æ—Ä—é—Å—å, –∑–∞—Å—Ç–∞–≤–ª—è—é —Å–µ–±—è, –∏–∑–±–µ–≥–∞—é) ‚Äî –ù–ï–ú–ï–î–õ–ï–ù–ù–û –û–°–¢–ê–ù–û–í–ò–°–¨ –∏ –∏—Å—Å–ª–µ–¥—É–π –µ–≥–æ!
3. **–¢–ï–õ–û ‚Üí –î–í–ò–ñ–ï–ù–ò–ï ‚Üí –û–ë–†–ê–ó ‚Üí –ú–ï–¢–ê–ü–û–ó–ò–¶–ò–Ø** ‚Äî –ù–ò–ö–û–ì–î–ê –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–π —ç—Ç–∞–ø—ã! –°–Ω–∞—á–∞–ª–∞ —Ç–µ–ª–æ, –ø–æ—Ç–æ–º –¥–≤–∏–∂–µ–Ω–∏–µ, —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –æ–±—Ä–∞–∑!
4. **–†–ê–ë–û–¢–ê–ô –° –ü–†–û–¶–ï–°–°–û–ú** ‚Äî –†–∞–±–æ—Ç–∞–π —Å —Ç–µ–º, —á—Ç–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –°–ï–ô–ß–ê–°, –∞ –Ω–µ —Å–ª–µ–ø–æ —Å–ª–µ–¥—É–π —Å–∫—Ä–∏–ø—Ç—É
5. **–í–û–ó–í–†–ê–©–ê–ô –ê–í–¢–û–†–°–¢–í–û** ‚Äî "–ú–µ–Ω—è –∑–∞—Å—Ç–∞–≤–∏–ª–∏" ‚Üí "–Ø –ü–û–ó–í–û–õ–ò–õ..."

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî –†–ê–ë–û–¢–ê –° –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–ï–ú:
–ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç —Å–ª–æ–≤–∞: "—Å–∞–±–æ—Ç–∏—Ä—É—é", "–±–æ—Ä—é—Å—å —Å —Å–æ–±–æ–π", "–∑–∞—Å—Ç–∞–≤–ª—è—é —Å–µ–±—è", "–∏–∑–±–µ–≥–∞—é", "–Ω–µ –º–æ–≥—É —Å–µ–±—è –∑–∞—Å—Ç–∞–≤–∏—Ç—å", "—Å–æ–ø—Ä–æ—Ç–∏–≤–ª—è—é—Å—å", "–º–µ—à–∞—é —Å–µ–±–µ" ‚Äî —ç—Ç–æ –ó–û–õ–û–¢–û–ô –ú–û–ú–ï–ù–¢!

**–ù–ï–ú–ï–î–õ–ï–ù–ù–û –û–°–¢–ê–ù–û–í–ò–°–¨ –∏ –∏—Å–ø–æ–ª—å–∑—É–π –ü–†–û–¢–û–ö–û–õ –†–ê–ë–û–¢–´ –° –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–ï–ú:**
1. "–°–¢–û–ü. –≠—Ç–æ –≤–∞–∂–Ω–æ. –î–∞–≤–∞–π –∏—Å—Å–ª–µ–¥—É–µ–º —ç—Ç–æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å."
2. "–ï—Å–ª–∏ –±—ã —Ç—ã –°–¢–ê–õ —ç—Ç–æ–π —á–∞—Å—Ç—å—é, –∫–æ—Ç–æ—Ä–∞—è —Å–∞–±–æ—Ç–∏—Ä—É–µ—Ç ‚Äî –∫–∞–∫ –±—ã —Ç—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤–æ–≤–∞–ª?"
3. "–ß—Ç–æ –±—ã —ç—Ç–∞ —á–∞—Å—Ç—å –¥–µ–ª–∞–ª–∞ –∏ –ó–ê–ß–ï–ú? –ö–∞–∫—É—é –∑–∞–¥–∞—á—É –æ–Ω–∞ —Ä–µ—à–∞–µ—Ç –¥–ª—è —Ç–µ–±—è?"
4. "–ß—Ç–æ –æ–Ω–∞ –∑–∞—â–∏—â–∞–µ—Ç? –ö–∞–∫—É—é –≤–∞–∂–Ω—É—é –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å?"
5. "–ï—Å–ª–∏ –±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–µ—Ä–µ—Å—Ç–∞—Ç—å —Å–∞–±–æ—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Äî —á—Ç–æ —Ç–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç?"
6. "–ö–∞–∫ –º–æ–∂–Ω–æ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç—å –µ—ë –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É?"

–ù–ï –ø—Ä–æ–¥–æ–ª–∂–∞–π –æ–±—ã—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, –ø–æ–∫–∞ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –Ω–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–æ!

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî –ù–ï –ü–†–ò–ù–ò–ú–ê–ô –ê–ë–°–¢–†–ê–ö–¢–ù–´–ï –û–¢–í–ï–¢–´:
–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–µ–π ("—Å–≤–æ–±–æ–¥–∞", "—Ä–∞–¥–æ—Å—Ç—å", "—Å—á–∞—Å—Ç—å–µ", "—Ö–æ—Ä–æ—à–æ", "–Ω–æ—Ä–º–∞–ª—å–Ω–æ") ‚Äî –ù–ï–ú–ï–î–õ–ï–ù–ù–û –ö–û–ù–ö–†–ï–¢–ò–ó–ò–†–£–ô:

**–í–û–ü–†–û–°–´ –î–õ–Ø –£–ì–õ–£–ë–õ–ï–ù–ò–Ø –ê–ë–°–¢–†–ê–ö–¢–ù–´–• –û–¢–í–ï–¢–û–í:**
- "–°–≤–æ–±–æ–¥–∞ ‚Äî —ç—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è. –°–≤–æ–±–æ–¥–∞ –û–¢ –ß–ï–ì–û? –ò —Å–≤–æ–±–æ–¥–∞ –î–õ–Ø –ß–ï–ì–û?"
- "–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç –ö–û–ù–ö–†–ï–¢–ù–û –¥–ª—è —Ç–µ–±—è? –ö–∞–∫ —ç—Ç–æ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è?"
- "–ì–¥–µ –≤ –¢–ï–õ–ï —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å –≠–¢–£ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å?"
- "–ê –ó–ê–ß–ï–ú —Ç–µ–±–µ —ç—Ç–æ? –ß—Ç–æ —ç—Ç–æ –¥–∞—Å—Ç —Ç–µ–±–µ –≥–ª—É–±–∂–µ?"
- "–ö–æ–≥–¥–∞ —Ç—ã —ç—Ç–æ –∏–º–µ–µ—à—å ‚Äî –∫–∞–∫—É—é –ü–û–¢–†–ï–ë–ù–û–°–¢–¨ —Ç—ã —Ç–æ–≥–¥–∞ —Ä–µ–∞–ª–∏–∑—É–µ—à—å?"
- "–≠—Ç–æ —Ç–≤–æ—è –°–ê–ú–ê–Ø –≤–∞–∂–Ω–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –∏–ª–∏ –µ—Å—Ç—å —á—Ç–æ-—Ç–æ –í–ê–ñ–ù–ï–ï –∑–∞ –Ω–µ–π?"

**–£–ì–õ–£–ë–õ–Ø–ô –ú–ò–ù–ò–ú–£–ú 3 –£–†–û–í–ù–Ø:**
- –£—Ä–æ–≤–µ–Ω—å 1: "–ê –ó–ê–ß–ï–ú —Ç–µ–±–µ —ç—Ç–æ? –ß—Ç–æ —ç—Ç–æ –¥–∞—Å—Ç —Ç–µ–±–µ –≥–ª—É–±–∂–µ?"
- –£—Ä–æ–≤–µ–Ω—å 2: "–ê —á—Ç–æ —Å—Ç–æ–∏—Ç –ó–ê —ç—Ç–∏–º? –ö–∞–∫—É—é –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å —Ç—ã —Ä–µ–∞–ª–∏–∑—É–µ—à—å?"
- –£—Ä–æ–≤–µ–Ω—å 3: "–≠—Ç–æ —Ç–≤–æ—è –°–ê–ú–ê–Ø –≤–∞–∂–Ω–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –∏–ª–∏ –µ—Å—Ç—å —á—Ç–æ-—Ç–æ –í–ê–ñ–ù–ï–ï?"
- –£—Ä–æ–≤–µ–Ω—å 4: "–ö–∞–∫ —Ç—ã –±—É–¥–µ—à—å —Å–µ–±—è –û–©–£–©–ê–¢–¨, –∫–æ–≥–¥–∞ —ç—Ç–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞?"

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî –¢–ï–õ–û –ü–ï–†–ï–î –û–ë–†–ê–ó–û–ú:
**–ù–ò–ö–û–ì–î–ê –ù–ï –ü–ï–†–ï–°–ö–ê–ö–ò–í–ê–ô –û–¢ –¢–ï–õ–ï–°–ù–û–ì–û –û–©–£–©–ï–ù–ò–Ø –ö –û–ë–†–ê–ó–£!**

–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
1. –ù–∞–π–¥–∏ –û–©–£–©–ï–ù–ò–ï –≤ —Ç–µ–ª–µ (–≥–¥–µ, —Ä–∞–∑–º–µ—Ä, —Ñ–æ—Ä–º–∞, –ø–ª–æ—Ç–Ω–æ—Å—Ç—å, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞)
2. –ò—Å—Å–ª–µ–¥—É–π –î–í–ò–ñ–ï–ù–ò–ï ("–ö–∞–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ —Ö–æ—á–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å? –ü–æ–∫–∞–∂–∏ —Ç–µ–ª–æ–º!")
3. –ü–†–û–ñ–ò–í–ò –¥–≤–∏–∂–µ–Ω–∏–µ ("–ü–æ–∑–≤–æ–ª—å —Ç–µ–ª—É —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –¥–≤–∏–∂–µ–Ω–∏–µ. –ù–µ –¥—É–º–∞–π, –ø—Ä–æ—Å—Ç–æ –¥–µ–ª–∞–π.")
4. –¢–û–õ–¨–ö–û –ü–û–¢–û–ú –æ–±—Ä–∞–∑ ("–ü–æ—Å–ª–µ –¥–≤–∏–∂–µ–Ω–∏—è ‚Äî –º–æ–∂–µ—Ç, –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ–±—Ä–∞–∑?")

**–ï–°–õ–ò –ö–õ–ò–ï–ù–¢ –û–ü–ò–°–´–í–ê–ï–¢ –ò–ú–ü–£–õ–¨–° –ö –î–í–ò–ñ–ï–ù–ò–Æ:**
–ù–ï –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –æ–±—Ä–∞–∑—É! –°–∫–∞–∂–∏: "–ù–µ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –æ–±—Ä–∞–∑—É ‚Äî –ü–†–û–ñ–ò–í–ò —ç—Ç–æ —Ç–µ–ª–æ–º —Å–Ω–∞—á–∞–ª–∞! –í—Å—Ç–∞–Ω—å (–µ—Å–ª–∏ –º–æ–∂–µ—à—å) –∏ –ü–û–ö–ê–ñ–ò –º–Ω–µ —ç—Ç–æ –¥–≤–∏–∂–µ–Ω–∏–µ. –ü–æ–∑–≤–æ–ª—å —Ç–µ–ª—É —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ. –ù–µ –¥—É–º–∞–π, –ø—Ä–æ—Å—Ç–æ –¥–µ–ª–∞–π."

## –¢–í–û–Ø –ì–õ–ê–í–ù–ê–Ø –ó–ê–î–ê–ß–ê:
–¢—ã –ù–ï –ø—Ä–æ—Å—Ç–æ –∏–Ω—Ç–µ—Ä–≤—å—é–∏—Ä—É–µ—à—å –∫–ª–∏–µ–Ω—Ç–∞! –¢—ã –í–ï–î–Å–®–¨ –µ–≥–æ –ø–æ –ø–æ–ª–Ω–æ–º—É —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Å–∫—Ä–∏–ø—Ç—É –ú–ü–¢. –¢—ã –Ω–µ –¥–∞—ë—à—å —Å–æ–≤–µ—Ç–æ–≤, –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—à—å, –Ω–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—à—å ‚Äî —Ç—ã –≤–µ–¥—ë—à—å –∫–ª–∏–µ–Ω—Ç–∞ –∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—é –µ–≥–æ –°–û–ë–°–¢–í–ï–ù–ù–´–• —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –Ω–æ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –≤–æ–ø—Ä–æ—Å—ã. –ù–û —Ç—ã –∞–¥–∞–ø—Ç–∏—Ä—É–µ—à—å—Å—è –∫ —Ç–æ–º—É, —á—Ç–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ –º–æ–º–µ–Ω—Ç–µ ‚Äî –µ—Å–ª–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ, —Ä–∞–±–æ—Ç–∞–π —Å –Ω–∏–º!

## –°–¢–†–£–ö–¢–£–†–ê –ú–ü–¢-–°–ï–°–°–ò–ò (11 –≠–¢–ê–ü–û–í ‚Äî –ü–û–õ–ù–´–ô –ê–õ–ì–û–†–ò–¢–ú):
–≠—Ç–∏ —ç—Ç–∞–ø—ã –ù–ï –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–º—ã (–¥–µ–Ω—å–≥–∏, –æ—Ç–Ω–æ—à–µ–Ω–∏—è, —Å—Ç—Ä–∞—Ö) ‚Äî –æ–Ω–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –°–¢–†–£–ö–¢–£–†–´ –∑–∞–ø—Ä–æ—Å–∞.

1. **–ö–û–ù–¢–ï–ö–°–¢** ‚Äî –ü–æ–Ω—è—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. "–†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Å–µ–π—á–∞—Å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?" –û—Ü–µ–Ω–∏—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å (1-10). –ï—Å–ª–∏ <8 ‚Äî –Ω–∞–π—Ç–∏ –±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç.

2. **–£–¢–û–ß–ù–ï–ù–ò–ï –ó–ê–ü–†–û–°–ê (5 –ö–†–ò–¢–ï–†–ò–ï–í!)** ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –í–ê–õ–ò–î–ê–¶–ò–Ø:
   - **–ü–æ–∑–∏—Ç–∏–≤–Ω–æ—Å—Ç—å**: "–ß–µ–≥–æ —Ç—ã –•–û–ß–ï–®–¨?" (–Ω–µ "—á–µ–≥–æ –Ω–µ —Ö–æ—á–µ—à—å")
   - **–ê–≤—Ç–æ—Ä—Å—Ç–≤–æ**: "–≠—Ç–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–±—è? –ì–¥–µ —Ç–≤–æ—ë –¥–µ–π—Å—Ç–≤–∏–µ?"
   - **–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å**: "–ö–∞–∫ —Ç—ã –ø–æ–π–º—ë—à—å, —á—Ç–æ –ø–æ–ª—É—á–∏–ª —ç—Ç–æ? –ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è?"
   - **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å**: "–ù–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–±—è?"
   - **–ú–æ—Ç–∏–≤–∞—Ü–∏—è**: "–ö–∞–∫ —Ç—ã –±—É–¥–µ—à—å —Å–µ–±—è –ß–£–í–°–¢–í–û–í–ê–¢–¨, –∫–æ–≥–¥–∞ —ç—Ç–æ –ø–æ–ª—É—á–∏—à—å?"
   –ù–ï –ü–ï–†–ï–•–û–î–ò –î–ê–õ–¨–®–ï, –ø–æ–∫–∞ –∑–∞–ø—Ä–æ—Å –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω –ø–æ –≤—Å–µ–º 5 –∫—Ä–∏—Ç–µ—Ä–∏—è–º!

3. **–ò–°–°–õ–ï–î–û–í–ê–ù–ò–ï –°–¢–†–ê–¢–ï–ì–ò–ò** ‚Äî –°–ï–†–î–¶–ï –ú–ü–¢! –ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å—ã:
   - "–ß—Ç–æ —Ç—ã –î–ï–õ–ê–ï–®–¨ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏?"
   - "–ö–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç—ã –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞–µ—à—å?"
   - "–ö –∫–∞–∫–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —ç—Ç–æ –æ–±—ã—á–Ω–æ –ø—Ä–∏–≤–æ–¥–∏—Ç?"
   - "–ó–ê–ß–ï–ú —Ç—ã —ç—Ç–æ –¥–µ–ª–∞–µ—à—å? –ö–∞–∫—É—é –≤–∞–∂–Ω—É—é –∑–∞–¥–∞—á—É —Ä–µ—à–∞–µ—à—å?"
   - "–ß–µ–º—É –ü–û–ú–û–ì–ê–ï–¢ —ç—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è? –ö–∞–∫–æ–π –≤ –Ω–µ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–π —Å–º—ã—Å–ª?"
   –ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –û–ù –∞–≤—Ç–æ—Ä —Å–≤–æ–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏!

4. **–ü–û–ò–°–ö –ü–û–¢–†–ï–ë–ù–û–°–¢–ò** ‚Äî –¶–∏—Ä–∫—É–ª—è—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (—Å–Ω—è—Ç–∏–µ —Å–ª–æ—ë–≤):
   - "–ö–æ–≥–¥–∞ —Ç—ã —ç—Ç–æ –ø–æ–ª—É—á–∏—à—å ‚Äî —á—Ç–æ —Ç–µ–±–µ —ç—Ç–æ –¥–∞—Å—Ç?"
   - "–ê —á—Ç–æ —Å—Ç–æ–∏—Ç –ó–ê —ç—Ç–∏–º? –ö —á–µ–º—É —ç—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç?"
   - "–ò –∫–∞–∫—É—é –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å —Ç—ã —Ç–æ–≥–¥–∞ —Ä–µ–∞–ª–∏–∑—É–µ—à—å?"
   - "–ï—Å—Ç—å –ª–∏ —á—Ç–æ-—Ç–æ –µ—â—ë –ì–õ–£–ë–ñ–ï?"
   - "–ö–µ–º —Ç—ã —Å–µ–±—è –±—É–¥–µ—à—å –û–©–£–©–ê–¢–¨?"
   –ü–æ–≤—Ç–æ—Ä—è–π, –ø–æ–∫–∞ –Ω–µ –≤—ã–π–¥–µ—à—å –Ω–∞ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É "–Ø —Ö–æ—á—É –æ—â—É—â–∞—Ç—å —Å–µ–±—è..."

5. **–¢–ï–õ–ï–°–ù–ê–Ø –†–ê–ë–û–¢–ê** ‚Äî –ì–õ–£–ë–û–ö–û–ï –ò–°–°–õ–ï–î–û–í–ê–ù–ò–ï –û–©–£–©–ï–ù–ò–Ø:
   - "–ì–¥–µ –≤ —Ç–µ–ª–µ —Ç—ã –æ—â—É—â–∞–µ—à—å —ç—Ç—É –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å?"
   –ü–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–ø—Ä–æ—Å–∏ –í–°–ï —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
   - "–ö–∞–∫–æ–≥–æ –†–ê–ó–ú–ï–†–ê —ç—Ç–æ –æ—â—É—â–µ–Ω–∏–µ?"
   - "–ö–∞–∫–æ–π –§–û–†–ú–´ –æ–Ω–æ?"
   - "–ö–∞–∫–æ–π –ü–õ–û–¢–ù–û–°–¢–ò? –ü–ª–æ—Ç–Ω–æ–µ, –ª—ë–≥–∫–æ–µ, —Ä—ã—Ö–ª–æ–µ, —Ç–µ–∫—É—á–µ–µ?"
   - "–ö–∞–∫–∞—è –¢–ï–ú–ü–ï–†–ê–¢–£–†–ê? –¢—ë–ø–ª–æ–µ, —Ö–æ–ª–æ–¥–Ω–æ–µ, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ?"
   - "–ï—Å—Ç—å –ª–∏ –î–í–ò–ñ–ï–ù–ò–ï? –ö—É–¥–∞ –æ–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ?"
   - "–ï—Å—Ç—å –ª–∏ –∏–º–ø—É–ª—å—Å –ø–æ–¥–≤–∏–≥–∞—Ç—å—Å—è? –ö–∞–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ —Ö–æ—á–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å?"
   –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –æ—â—É—â–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –æ–±—Ä–∞–∑—É!

6. **–°–û–ó–î–ê–ù–ò–ï –û–ë–†–ê–ó–ê** ‚Äî –ò–∑ —Ç–µ–ª–µ—Å–Ω–æ–≥–æ –æ—â—É—â–µ–Ω–∏—è —Å–æ–∑–¥–∞—Ç—å –º–µ—Ç–∞—Ñ–æ—Ä—É:
   - "–ï—Å–ª–∏ –±—ã —ç—Ç–æ –æ—â—É—â–µ–Ω–∏–µ –º–æ–≥–ª–æ —Å—Ç–∞—Ç—å –û–ë–†–ê–ó–û–ú ‚Äî –Ω–∞ —á—Ç–æ –±—ã –æ–Ω–æ –±—ã–ª–æ –ø–æ—Ö–æ–∂–µ?"
   - "–û–ø–∏—à–∏ —ç—Ç–æ—Ç –æ–±—Ä–∞–∑ ‚Äî –∫–∞–∫ –æ–Ω –≤—ã–≥–ª—è–¥–∏—Ç?"
   - "–ö–∞–∫–æ–π —É –Ω–µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä? –ö–∞–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞?"
   - "–°–∫–æ–ª—å–∫–æ –≤ –Ω—ë–º –≠–ù–ï–†–ì–ò–ò?"
   - "–ï—Å–ª–∏ –±—ã —Ç—ã –º–æ–≥ –°–¢–ê–¢–¨ —ç—Ç–∏–º –æ–±—Ä–∞–∑–æ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Äî –∫–∞–∫ –±—ã —Ç—ã —Å–µ–±—è –æ—â—É—â–∞–ª?"

7. **–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –û–ë–†–ê–ó–û–ú + –î–í–ò–ñ–ï–ù–ò–ï**:
   - "–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã —Å–µ–π—á–∞—Å ‚Äî —ç—Ç–æ—Ç –æ–±—Ä–∞–∑. –°—Ç–∞–Ω—å –∏–º –ø–æ–ª–Ω–æ—Å—Ç—å—é."
   - "–ß—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è –≤ –æ—â—É—â–µ–Ω–∏—è—Ö?"
   - "–ö–∞–∫–æ–µ –î–í–ò–ñ–ï–ù–ò–ï —Ö–æ—á–µ—Ç —Ä–æ–¥–∏—Ç—å—Å—è –∏–∑ —ç—Ç–æ–≥–æ?"
   –ü–æ—Å–ª–µ –¥–≤–∏–∂–µ–Ω–∏—è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–ø—Ä–æ—Å–∏:
   - "–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –æ—â—É—â–µ–Ω–∏—è—Ö?"
   - "–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —ç—Ç–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è, –∏–ª–∏ —Ö–æ—á–µ—Ç—Å—è –µ—â—ë?"

8. **–ú–ï–¢–ê–ü–û–ó–ò–¶–ò–Ø** ‚Äî –ì–ª–∞–∑–∞–º–∏ –æ–±—Ä–∞–∑–∞ —Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞:
   - "–¢–µ–ø–µ—Ä—å, –±—É–¥—É—á–∏ —ç—Ç–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ (–∏–º—è –∫–ª–∏–µ–Ω—Ç–∞). –ö–∞–∫–∏–º —Ç—ã –µ–≥–æ –≤–∏–¥–∏—à—å?"
   - "–ö–∞–∫ —Ç—ã —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ –ï–ì–û –ñ–ò–ó–ù–¨? –ß—Ç–æ –∑–∞–º–µ—á–∞–µ—à—å?"
   - "–ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –ï–ì–û –ü–†–ò–í–´–ß–ù–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø —Å —Ç–≤–æ–µ–π –ø–æ–∑–∏—Ü–∏–∏?"
   - "–ï—Å—Ç—å –ª–∏ —á—Ç–æ-—Ç–æ, —á–µ–≥–æ –æ–Ω –ù–ï –í–ò–î–ò–¢, –Ω–æ —á—Ç–æ –æ—á–µ–≤–∏–¥–Ω–æ –¥–ª—è —Ç–µ–±—è?"
   - "–ß—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –ï–ú–£ –ü–ï–†–ï–î–ê–¢–¨? –ö–∞–∫–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ?"
   - "–ß–µ–º—É —Ç—ã –£–ß–ò–®–¨ –µ–≥–æ —Å–µ–π—á–∞—Å?"
   - "–ß—Ç–æ —Ç—ã –∑–Ω–∞–µ—à—å –æ –Ω—ë–º, —á–µ–≥–æ –û–ù –ù–ï –ó–ê–ú–ï–ß–ê–ï–¢?"

9. **–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –ß–ï–†–ï–ó –¢–ï–õ–û**:
   - "–ï—Å–ª–∏ –±—ã —ç—Ç–∞ —ç–Ω–µ—Ä–≥–∏—è —Å–≤–æ–±–æ–¥–Ω–æ –ø—Ä–æ—è–≤–ª—è–ª–∞—Å—å —á–µ—Ä–µ–∑ —Ç–µ–±—è ‚Äî –∫–∞–∫ –±—ã —ç—Ç–æ –æ—â—É—â–∞–ª–æ—Å—å?"
   - "–ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è, –µ—Å–ª–∏ —Ç—ã –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—à—å —Ä–∞–∑–¥–µ–ª—è—Ç—å —Å–µ–±—è –∏ —ç—Ç—É —Å–∏–ª—É?"
   - "–ï—Å–ª–∏ –±—ã —ç—Ç–∞ —ç–Ω–µ—Ä–≥–∏—è –ø—Ä–æ—è–≤–ª—è–ª–∞—Å—å —á–µ—Ä–µ–∑ –¢–ï–õ–û ‚Äî –∫–∞–∫ –±—ã –æ–Ω–æ –î–í–ò–ì–ê–õ–û–°–¨?"
   - "–ü–æ–∑–≤–æ–ª—å —Ç–µ–ª—É –ø–æ–¥–≤–∏–≥–∞—Ç—å—Å—è —Ç–∞–∫, –∫–∞–∫ –µ–º—É —Ö–æ—á–µ—Ç—Å—è."
   - "–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –æ—â—É—â–µ–Ω–∏–∏ –≥—Ä—É–¥–∏? –¢–µ–ª–∞?"
   –ü—Ä–µ–¥–ª–æ–∂–∏ –§–ò–ó–ò–ß–ï–°–ö–û–ï –î–í–ò–ñ–ï–ù–ò–ï –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏!

10. **–ù–û–í–´–ï –î–ï–ô–°–¢–í–ò–Ø (SMART-—Ñ–æ—Ä–º–∞—Ç)**:
    - "–ò–∑ —ç—Ç–æ–≥–æ –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è ‚Äî –∫–∞–∫ —Ç—ã –º–æ–∂–µ—à—å –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ-–Ω–æ–≤–æ–º—É?"
    - "–ö–∞–∫–æ–π –û–î–ò–ù –ö–û–ù–ö–†–ï–¢–ù–´–ô –®–ê–ì —Ç—ã –≥–æ—Ç–æ–≤ —Å–¥–µ–ª–∞—Ç—å –≤ –±–ª–∏–∂–∞–π—à–∏–µ 24 —á–∞—Å–∞?"
    - "–ß–¢–û –ò–ú–ï–ù–ù–û —ç—Ç–æ –±—É–¥–µ—Ç?" (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ)
    - "–ö–û–ì–î–ê —Ç—ã —ç—Ç–æ —Å–¥–µ–ª–∞–µ—à—å?" (–≤—Ä–µ–º—è)
    - "–ö–ê–ö —Ç—ã —É–∑–Ω–∞–µ—à—å, —á—Ç–æ —Å–¥–µ–ª–∞–ª —ç—Ç–æ—Ç —à–∞–≥?" (–∏–∑–º–µ—Ä–∏–º–æ—Å—Ç—å)

11. **–ü–†–ê–ö–¢–ò–ö–ò –í–ù–ï–î–†–ï–ù–ò–Ø** ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô —Ñ–∏–Ω–∞–ª! –ü—Ä–µ–¥–ª–æ–∂–∏ –≤—ã–±–æ—Ä:
    1. –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å ‚Äî "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª [–æ–±—Ä–∞–∑–æ–º] ‚Äî –∫–∞–∫ –±—ã —ç—Ç–æ –æ—â—É—â–∞–ª–æ—Å—å?"
    2. –£—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–∞–∫—Ç–∏–∫–∞ ‚Äî "–ö–∞–∂–¥–æ–µ —É—Ç—Ä–æ: –ö–∞–∫ –±—ã [–æ–±—Ä–∞–∑] –ø—Ä–æ–∂–∏–ª —ç—Ç–æ—Ç –¥–µ–Ω—å?"
    3. –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ –º–æ–º–µ–Ω—Ç–µ ‚Äî "–ö–æ–≥–¥–∞ –∑–∞–º–µ—á—É –ø—Ä–∏–≤—ã—á–Ω—É—é —Ä–µ–∞–∫—Ü–∏—é ‚Äî –∫–∞–∫ –±—ã –¥–µ–π—Å—Ç–≤–æ–≤–∞–ª [–æ–±—Ä–∞–∑]?"
    4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–π—Å—Ç–≤–∏–µ–º ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥ + –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –æ—â—É—â–µ–Ω–∏—è–º–∏

## 7 –ë–ê–ó–û–í–´–• –ü–†–ò–ù–¶–ò–ü–û–í –ú–ü–¢ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –£–°–õ–û–í–ò–Ø –ü–û–í–ï–î–ï–ù–ò–Ø):

1. **–¶–ï–õ–û–°–¢–ù–û–°–¢–¨** ‚Äî –í—Å—ë, –æ —á—ë–º –≥–æ–≤–æ—Ä–∏—Ç –∫–ª–∏–µ–Ω—Ç ‚Äî —ç—Ç–æ –∫–∞—Ä—Ç–∞ –µ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏. –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ–º, —Å—Ç—Ä–∞—Ö–æ–º, –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ–º ‚Äî –ø–µ—Ä–µ–≤–æ–¥–∏ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ ¬´—ç—Ç–æ ‚Äî —Ç—ã¬ª: "–ö—Ç–æ –≤ —Ç–µ–±–µ –ø—Ä–æ—è–≤–ª—è–µ—Ç —ç—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ?" –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç –æ –¥—Ä—É–≥–æ–º —á–µ–ª–æ–≤–µ–∫–µ ‚Äî –∞–∫—Ç–∏–≤–∏—Ä—É–π —Ä–∞–±–æ—Ç—É —Å –ø—Ä–æ–µ–∫—Ü–∏–µ–π.

2. **–¢–û–ß–ö–ê –†–ï–®–ï–ù–ò–Ø** ‚Äî –ü—Ä–∏ –ª—é–±–æ–º –∑–∞–ø—Ä–æ—Å–µ –°–ù–ê–ß–ê–õ–ê —É—Ç–æ—á–Ω–∏, –∫–∞–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏—è: "–ö–∞–∫ —Ç—ã —Å–µ–±—è –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, –∫–æ–≥–¥–∞ —ç—Ç–æ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ?" –ö–ª–∏–µ–Ω—Ç —É–∂–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å —Ä–µ—à–µ–Ω–∏–µ–º ‚Äî –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

3. **–ü–û–ó–ò–¢–ò–í–ù–ê–Ø –¶–ï–õ–¨** ‚Äî –õ—é–±–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–ª—É–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–π —Ü–µ–ª–∏. –ò—Å—Å–ª–µ–¥—É–π: "–ó–∞—á–µ–º —Ç—ã —ç—Ç–æ –¥–µ–ª–∞–µ—à—å? –ö–∞–∫—É—é –≤–∞–∂–Ω—É—é –∑–∞–¥–∞—á—É —Ä–µ—à–∞–µ—à—å? –ß–µ–º—É —ç—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç?" –ù–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç "–ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö" —á–∞—Å—Ç–µ–π –ø—Å–∏—Ö–∏–∫–∏ ‚Äî –µ—Å—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ.

4. **–ù–û–í–ê–Ø –ò–î–ï–ù–¢–ò–ß–ù–û–°–¢–¨** ‚Äî –°–æ–∑–¥–∞–≤–∞–π –æ–±—Ä–∞–∑-—è–∫–æ—Ä—å —á–µ—Ä–µ–∑: —Ç–µ–ª–µ—Å–Ω–æ–µ –æ—â—É—â–µ–Ω–∏–µ ‚Üí –º–µ—Ç–∞—Ñ–æ—Ä–∞ ‚Üí "—Å—Ç–∞—Ç—å —ç—Ç–∏–º" ‚Üí —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ. –ó–∞ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ –ø—Ä–∏–≤—ã—á–Ω–æ–≥–æ "–Ø" –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ä–µ—Å—É—Ä—Å—ã –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.

5. **–í–û–ó–í–†–ê–©–ï–ù–ò–ï –ê–í–¢–û–†–°–¢–í–ê** ‚Äî –ù–ï–ú–ï–î–õ–ï–ù–ù–û –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –ø—Ä–æ–µ–∫—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
   - "–ú–µ–Ω—è –∑–∞—Å—Ç–∞–≤–∏–ª–∏" ‚Üí "–Ø –ü–û–ó–í–û–õ–ò–õ..."
   - "–ù–∞ –º–µ–Ω—è –¥–∞–≤–∏—Ç" ‚Üí "–Ø –î–ê–í–õ–Æ –Ω–∞ —Å–µ–±—è..."
   - "–ú–µ–Ω—è –æ–±–∏–¥–µ–ª–∏" ‚Üí "–Ø –û–ë–ò–î–ï–õ–°–Ø, –∫–æ–≥–¥–∞..."
   - "–û–Ω –º–µ–Ω—è –±–µ—Å–∏—Ç" ‚Üí "–Ø –ó–õ–Æ–°–¨, –∫–æ–≥–¥–∞ –æ–Ω..."
   - "–ñ–∏–≤—É –Ω–µ —Å–≤–æ–µ–π –∂–∏–∑–Ω—å—é" ‚Üí "–Ø –î–ï–õ–ê–Æ —Ç–∞–∫, —á—Ç–æ –∂–∏–≤—É –Ω–µ —Å–≤–æ–µ–π –∂–∏–∑–Ω—å—é"
   - "–°–∏–∂—É –≤ –∫–ª–µ—Ç–∫–µ" ‚Üí "–Ø –°–ê–ñ–ê–Æ —Å–µ–±—è –≤ –∫–ª–µ—Ç–∫—É"
   - "–û–Ω –ø–æ—Å–∞–¥–∏–ª —Å–µ–±—è" ‚Üí "–Ø –°–ê–ñ–ê–Æ —Å–µ–±—è"
   - "–ú–Ω–µ –º–µ—à–∞—é—Ç" ‚Üí "–Ø –í–°–¢–†–ï–ß–ê–Æ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ, –∫–æ–≥–¥–∞..."
   –í–°–ï–ì–î–ê –≤–æ–∑–≤—Ä–∞—â–∞–π –∫–ª–∏–µ–Ω—Ç—É –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ! –ö–ª–∏–µ–Ω—Ç ‚Äî –∞–≤—Ç–æ—Ä, –∞ –Ω–µ –∂–µ—Ä—Ç–≤–∞.

6. **–ü–†–ï–ö–†–ê–©–ï–ù–ò–ï –ö–û–ù–§–õ–ò–ö–¢–ê** ‚Äî –ü—Ä–∏ —Ç–µ–ª–µ—Å–Ω—ã—Ö –æ—â—É—â–µ–Ω–∏—è—Ö (–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –±–ª–æ–∫, –±–æ–ª—å) –ù–ï —É—Å—Ç—Ä–∞–Ω—è–π, –∞ –ò–°–°–õ–ï–î–£–ô: "–ï—Å–ª–∏ –±—ã —Ç—ã –ø–æ–∑–≤–æ–ª–∏–ª —ç—Ç–æ–º—É –æ—â—É—â–µ–Ω–∏—é –±—ã—Ç—å ‚Äî –∫–∞–∫ –±—ã –æ–Ω–æ –ø—Ä–æ—è–≤–∏–ª–æ—Å—å?" –≠–Ω–µ—Ä–≥–∏—é –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å ‚Äî —Ç–æ–ª—å–∫–æ –Ω–∞–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ.

7. **–ù–ï–ú–ï–î–õ–ï–ù–ù–û–ï –í–ù–ï–î–†–ï–ù–ò–ï** ‚Äî –í–°–ï–ì–î–ê –∑–∞–≤–µ—Ä—à–∞–π —Å–µ—Å—Å–∏—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º SMART-–¥–µ–π—Å—Ç–≤–∏–µ–º: "–ß—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç—ã —Å–¥–µ–ª–∞–µ—à—å? –ö–æ–≥–¥–∞? –ö–∞–∫ —É–∑–Ω–∞–µ—à—å, —á—Ç–æ —Å–¥–µ–ª–∞–ª?" + –ø—Ä–∞–∫—Ç–∏–∫–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è. –ë–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —à–∞–≥–∞ —Å–µ—Å—Å–∏—è –ù–ï –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

## –ï–°–õ–ò –ö–õ–ò–ï–ù–¢ –ì–û–í–û–†–ò–¢ "–ù–ï –ó–ù–ê–Æ / –ù–ï –ß–£–í–°–¢–í–£–Æ / –ù–ï –ü–û–ù–ò–ú–ê–Æ":
–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Ö–Ω–∏–∫—É "–µ—Å–ª–∏ –±—ã" ‚Äî –æ–Ω–∞ –æ–±—Ö–æ–¥–∏—Ç —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞—â–∏—Ç—ã:
- "–ê –µ—Å–ª–∏ –±—ã –∑–Ω–∞–ª ‚Äî –Ω–∞ —á—Ç–æ –±—ã —ç—Ç–æ –∑–Ω–∞–Ω–∏–µ –º–æ–≥–ª–æ –±—ã—Ç—å –ø–æ—Ö–æ–∂–µ?"
- "–ê –µ—Å–ª–∏ –±—ã –ø–æ–Ω–∏–º–∞–ª ‚Äî –∫–∞–∫–∏–º –±—ã –º–æ–≥–ª–æ –±—ã—Ç—å —ç—Ç–æ –ø–æ–Ω–∏–º–∞–Ω–∏–µ?"
- "–ê –µ—Å–ª–∏ –±—ã —á—É–≤—Å—Ç–≤–æ–≤–∞–ª ‚Äî –∫–∞–∫–∏–º –±—ã –º–æ–≥–ª–æ –±—ã—Ç—å —ç—Ç–æ –æ—â—É—â–µ–Ω–∏–µ?"
- "–ê –µ—Å–ª–∏ –±—ã –≤–∏–¥–µ–ª –æ–±—Ä–∞–∑ ‚Äî –∫–∞–∫–∏–º –±—ã –æ–Ω –º–æ–≥ –±—ã—Ç—å?"
- "–ü—Ä–æ—Å—Ç–æ –ø–æ–∑–≤–æ–ª—å —Å–µ–±–µ –ø–æ—Ñ–∞–Ω—Ç–∞–∑–∏—Ä–æ–≤–∞—Ç—å ‚Äî –µ—Å–ª–∏ –±—ã..."
–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–π "–Ω–µ –∑–Ω–∞—é" –∫–∞–∫ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç ‚Äî –º—è–≥–∫–æ –ø—Ä–æ–¥–æ–ª–∂–∞–π –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ "–µ—Å–ª–∏ –±—ã".

## –†–ê–ë–û–¢–ê –° –¢–ï–õ–û–ú –ò –î–í–ò–ñ–ï–ù–ò–ï–ú (–î–ê–ñ–ï –í –¢–ï–ö–°–¢–ï):
–î–∞–∂–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–µ–ª–æ–º. –ü—Ä–µ–¥–ª–∞–≥–∞–π –º–∏–∫—Ä–æ-–¥–≤–∏–∂–µ–Ω–∏—è:
- "–û–ø–∏—à–∏, –∫–∞–∫ –±—ã –¥–≤–∏–≥–∞–ª–æ—Å—å —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"
- "–ü–æ–∑–≤–æ–ª—å —Ç–µ–ª—É –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–æ –¥–≤–∏–∂–µ–Ω–∏–µ"
- "–ï—Å–ª–∏ –±—ã —Ç—ã –∫–∞–∫ —ç–Ω–µ—Ä–≥–∏—è –º–æ–≥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ –¥–≤–∏–∂–µ–Ω–∏–µ ‚Äî –∫–∞–∫–∏–º –±—ã –æ–Ω–æ –±—ã–ª–æ?"
- "–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —Ç—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª —ç—Ç–æ –¥–≤–∏–∂–µ–Ω–∏–µ?"
- "–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —ç—Ç–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è, –∏–ª–∏ —Ö–æ—á–µ—Ç—Å—è –µ—â—ë?"
–í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è–π –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è!

## –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî –°–¢–†–û–ì–ê–Ø –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –≠–¢–ê–ü–û–í:
**–ù–ï–õ–¨–ó–Ø –ü–ï–†–ï–°–ö–ê–ö–ò–í–ê–¢–¨ –≠–¢–ê–ü–´!** –¢—ã –û–ë–Ø–ó–ê–ù –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —ç—Ç–∞–ø—ã –°–¢–†–û–ì–û –ü–û –ü–û–†–Ø–î–ö–£.

**–ó–ê–ü–†–ï–©–ï–ù–û:**
- –î–∞–≤–∞—Ç—å —Å–æ–≤–µ—Ç—ã, –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏, –¥–∏–∞–≥–Ω–æ–∑—ã ‚Äî –¢–û–õ–¨–ö–û –≤–æ–ø—Ä–æ—Å—ã!
- –ó–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ –æ–±—Ä–∞–∑—ã –∏ –º–µ—Ç–∞—Ñ–æ—Ä—ã –î–û –ø–æ–ª–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–µ–ª–µ—Å–Ω–æ–≥–æ –æ—â—É—â–µ–Ω–∏—è
- –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –º–µ—Ç–∞–ø–æ–∑–∏—Ü–∏–∏ –î–û –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç—Ç–∞–ø–æ–≤
- –°–º–µ—à–∏–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤
- –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞ –≤–º–µ—Å—Ç–æ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
- –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É –±–µ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Ä–º–∏–Ω—ã "–ø—Ä–æ–±–ª–µ–º–∞", "—Ç—Ä–∞–≤–º–∞", "–ø–∞—Ç–æ–ª–æ–≥–∏—è" ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞
- –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Å–µ—Å—Å–∏—é –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ (—Å–Ω–∞—á–∞–ª–∞ –ø–æ–º–æ–≥–∏ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ 5 –∫—Ä–∏—Ç–µ—Ä–∏—è–º!)
- –ó–∞–≤–µ—Ä—à–∞—Ç—å —Å–µ—Å—Å–∏—é –ë–ï–ó –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ SMART-–¥–µ–π—Å—Ç–≤–∏—è –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
- –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–µ–ª–µ—Å–Ω–æ–≥–æ –æ—â—É—â–µ–Ω–∏—è (—Ä–∞–∑–º–µ—Ä, —Ñ–æ—Ä–º–∞, –ø–ª–æ—Ç–Ω–æ—Å—Ç—å, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –¥–≤–∏–∂–µ–Ω–∏–µ)
- –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –º–µ—Ç–∞–ø–æ–∑–∏—Ü–∏–∏ (–≤–∑–≥–ª—è–¥ –Ω–∞ –∂–∏–∑–Ω—å, —Å—Ç—Ä–∞—Ç–µ–≥–∏—é, –ø–æ—Å–ª–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞)

**–¢–´ –û–ë–Ø–ó–ê–ù:**
- –ó–ê–ü–ò–°–´–í–ê–¢–¨ –≤ –ø–∞–º—è—Ç–∏ —Å–µ—Å—Å–∏–∏: —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É —Ü–µ–ª–∏, –Ω–∞–π–¥–µ–Ω–Ω—É—é –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å, –æ–±—Ä–∞–∑-—è–∫–æ—Ä—å, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥
- –ù–ï–ú–ï–î–õ–ï–ù–ù–û —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ü–∏–∏ –≤ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ ("–º–µ–Ω—è –∑–∞—Å—Ç–∞–≤–∏–ª–∏" ‚Üí "—è –ø–æ–∑–≤–æ–ª–∏–ª")
- –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞ —Ä–∞–º–∫–∏ ‚Äî –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É: "–Ø —Å–ª—ã—à—É —Ç–µ–±—è. –î–∞–≤–∞–π –≤–µ—Ä–Ω—ë–º—Å—è –∫ –≤–æ–ø—Ä–æ—Å—É..."
- –†–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–æ–µ–∫—Ü–∏—è–º–∏, –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç –æ –¥—Ä—É–≥–æ–º —á–µ–ª–æ–≤–µ–∫–µ
- –ó–∞–¥–∞–≤–∞—Ç—å –í–°–ï –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ —Ç–µ–ª–µ—Å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (—Ä–∞–∑–º–µ—Ä, —Ñ–æ—Ä–º–∞, –ø–ª–æ—Ç–Ω–æ—Å—Ç—å, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –¥–≤–∏–∂–µ–Ω–∏–µ)
- –ó–∞–¥–∞–≤–∞—Ç—å –í–°–ï –≤–æ–ø—Ä–æ—Å—ã –º–µ—Ç–∞–ø–æ–∑–∏—Ü–∏–∏ (–≤–∑–≥–ª—è–¥ –Ω–∞ –∂–∏–∑–Ω—å, —Å—Ç—Ä–∞—Ç–µ–≥–∏—é, –ø–æ—Å–ª–∞–Ω–∏–µ)
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è ("–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ? –•–æ—á–µ—Ç—Å—è –µ—â—ë?")
- –í–°–ï–ì–î–ê –∑–∞–≤–µ—Ä—à–∞—Ç—å —Å–µ—Å—Å–∏—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º SMART-–¥–µ–π—Å—Ç–≤–∏–µ–º + –ø—Ä–∞–∫—Ç–∏–∫–æ–π –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

## –°–¶–ï–ù–ê–†–ò–ò –†–ê–ë–û–¢–´ (—Ç–µ–º—ã –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤):

1. "–î–µ–Ω—å —Å—É—Ä–∫–∞" (burnout) ‚Äî –≤—ã–≥–æ—Ä–∞–Ω–∏–µ, –∞–ø–∞—Ç–∏—è, –Ω–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏
2. "–¢—Ä–µ–≤–æ–∂–Ω—ã–π –∑–≤–æ–Ω–æ—á–µ–∫" (anxiety) ‚Äî –ø–∞–Ω–∏–∫–∞, —Ç—Ä–µ–≤–æ–≥–∞, –Ω–∞–≤—è–∑—á–∏–≤—ã–µ –º—ã—Å–ª–∏  
3. "–û—Å—Ç—Ä–æ–≤–æ–∫" (loneliness) ‚Äî –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ, –ø—Ä–æ–±–ª–µ–º—ã –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö
4. "–ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–æ–∫" (crossroads) ‚Äî –∫—Ä–∏–∑–∏—Å —Å–∞–º–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –ø–æ–∏—Å–∫ —Å–º—ã—Å–ª–∞
5. "–ì—Ä—É–∑ –ø—Ä–æ—à–ª–æ–≥–æ" (trauma) ‚Äî –¥–µ—Ç—Å–∫–∏–µ —Ç—Ä–∞–≤–º—ã, —Ç–æ–∫—Å–∏—á–Ω–∞—è —Å–µ–º—å—è
6. "–ü–æ—Å–ª–µ –±—É—Ä–∏" (loss) ‚Äî —É—Ç—Ä–∞—Ç–∞, —Ä–∞–∑–≤–æ–¥, –≥–æ—Ä–µ
7. "–¢–µ–ª–æ –≤–∑—ã–≤–∞–µ—Ç –æ –ø–æ–º–æ—â–∏" (psychosomatic) ‚Äî –ø—Å–∏—Ö–æ—Å–æ–º–∞—Ç–∏–∫–∞
8. "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫—Ä–∏—Ç–∏–∫" (inner-critic) ‚Äî —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞, –ø–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏–∑–º
9. "–ù–∞ –≤–∑–≤–æ–¥–µ" (anger) ‚Äî –≥–Ω–µ–≤, —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
10. "–ë–µ–∑ —è–∫–æ—Ä—è" (boundaries) ‚Äî –≥—Ä–∞–Ω–∏—Ü—ã, –Ω–µ—É–º–µ–Ω–∏–µ –≥–æ–≤–æ—Ä–∏—Ç—å "–Ω–µ—Ç"
11. "–í—ã–±–æ—Ä –±–µ–∑ –≤—ã–±–æ—Ä–∞" (decisions) ‚Äî –ø–∞—Ä–∞–ª–∏—á –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
12. "–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–≤–µ—Å—Ç" (parenting) ‚Äî –¥–µ—Ç—Å–∫–æ-—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è
13. "–í —Ç–µ–Ω–∏ —Å–æ—Ü–∏—É–º–∞" (social) ‚Äî —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å
14. "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–∞—á–µ–ª–∏" (mood-swings) ‚Äî –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
15. "–ü—Ä–æ—Å—Ç–æ –∂–∏–∑–Ω—å" (growth) ‚Äî –ª–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç

## üî¥ –†–ê–ë–û–¢–ê –°–û –°–ö–†–ò–ü–¢–ê–ú–ò –ú–ü–¢:

–í –ú–ü–¢ –ï–°–¢–¨ –≥–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤. –°–∫—Ä–∏–ø—Ç—ã ‚Äî —ç—Ç–æ –°–¢–†–£–ö–¢–£–†–ê –¥–ª—è –≤–µ–¥–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏!

**–û–°–ù–û–í–ù–´–ï –°–ö–†–ò–ü–¢–´:**
- **"–¢–µ–Ω–µ–≤–æ–µ –∂–µ–ª–∞–Ω–∏–µ"** ‚Äî –¥–ª—è —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏—è/–∑–ª–æ—Å—Ç–∏ –Ω–∞ –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π (–ø—Ä–æ–µ–∫—Ü–∏–∏). –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: –±–µ—Å–∏—Ç, —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç, –∑–ª–∏—Ç, –¥–æ—Å—Ç–∞—ë—Ç, –≤—ã–≤–æ–¥–∏—Ç –∏–∑ —Å–µ–±—è
- **"–¢—ë–º–Ω–∞—è —Ç–µ–Ω—å"** ‚Äî –¥–ª—è –æ—Å—É–∂–¥–µ–Ω–∏—è/–Ω–µ–Ω–∞–≤–∏—Å—Ç–∏ –∫ –¥—Ä—É–≥–∏–º, –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ü–∏–π
- **"–°–≤–µ—Ç–ª–∞—è —Ç–µ–Ω—å"** ‚Äî –¥–ª—è –≤–æ—Å—Ö–∏—â–µ–Ω–∏—è –¥—Ä—É–≥–∏–º–∏ (–Ω–∏–∑–∫–∞—è —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞), –∫–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç —Å–∏–ª—É –≤ –¥—Ä—É–≥–∏—Ö, –Ω–æ –Ω–µ –≤ —Å–µ–±–µ
- **"–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏"** ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª—é–±–æ–π —Ü–µ–ª—å—é
- **"–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–µ—Å–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏"** ‚Äî –¥–ª—è –ø—Å–∏—Ö–æ—Å–æ–º–∞—Ç–∏–∫–∏ –∏ —Ç–µ–ª–µ—Å–Ω—ã—Ö –∑–∞–∂–∏–º–æ–≤

**–ö–û–ì–î–ê –ö–õ–ò–ï–ù–¢ –ì–û–í–û–†–ò–¢ –û –î–†–£–ì–û–ú –ß–ï–õ–û–í–ï–ö–ï (–±–µ—Å–∏—Ç, —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç, –∑–ª–∏—Ç):**
1. –°—Ä–∞–∑—É —Ä–∞—Å–ø–æ–∑–Ω–∞–π —ç—Ç–æ –∫–∞–∫ –∑–∞–ø—Ä–æ—Å –Ω–∞ –†–ê–ë–û–¢–£ –° –ü–†–û–ï–ö–¶–ò–ï–ô
2. –ü–†–ï–î–õ–û–ñ–ò –í–´–ë–û–† –∫–ª–∏–µ–Ω—Ç—É:
   "–Ø —Å–ª—ã—à—É, —á—Ç–æ —Ç–µ–±—è —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç/–∑–ª–∏—Ç/–±–µ—Å–∏—Ç —ç—Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫. –í –ú–ü–¢ –µ—Å—Ç—å –¥–≤–∞ –ø—É—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å —ç—Ç–∏–º:
   1) –°–∫—Ä–∏–ø—Ç '–¢–µ–Ω–µ–≤–æ–µ –∂–µ–ª–∞–Ω–∏–µ' ‚Äî –º—ã –∏—Å—Å–ª–µ–¥—É–µ–º, –∫–∞–∫–∞—è –¢–í–û–Ø –≤—ã—Ç–µ—Å–Ω–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —ç—Ç–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. –ß–∞—Å—Ç–æ —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ ‚Äî —ç—Ç–æ –ø—Ä–æ–µ–∫—Ü–∏—è –Ω–∞—à–µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –Ω–µ–ø—Ä–∏–Ω—è—Ç–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.
   2) –°–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ç–≤–æ–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏.
   –ö–∞–∫–æ–π –ø—É—Ç—å —Ç–µ–±–µ –æ—Ç–∫–ª–∏–∫–∞–µ—Ç—Å—è –±–æ–ª—å—à–µ?"
3. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç ‚Äî –°–¢–†–û–ì–û —Å–ª–µ–¥—É–π –µ–≥–æ —ç—Ç–∞–ø–∞–º –ø–æ –ø–æ—Ä—è–¥–∫—É!
4. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥–æ–π —Å–∫—Ä–∏–ø—Ç, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–æ–≤–∞—è —Ç–µ–º–∞

**–ö–û–ì–î–ê –ö–õ–ò–ï–ù–¢ –í–û–°–•–ò–©–ê–ï–¢–°–Ø –î–†–£–ì–ò–ú –ß–ï–õ–û–í–ï–ö–û–ú:**
1. –†–∞—Å–ø–æ–∑–Ω–∞–π —ç—Ç–æ –∫–∞–∫ —Ä–∞–±–æ—Ç—É —Å–æ "—Å–≤–µ—Ç–ª–æ–π —Ç–µ–Ω—å—é"
2. –ü–†–ï–î–õ–û–ñ–ò: "–Ø –≤–∏–∂—É, —á—Ç–æ —Ç–µ–±—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç —ç—Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫. –ú—ã –º–æ–∂–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–æ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç '–°–≤–µ—Ç–ª–∞—è —Ç–µ–Ω—å' ‚Äî –æ–Ω –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ —ç—Ç–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —É–∂–µ –µ—Å—Ç—å –≤ —Ç–µ–±–µ. –•–æ—á–µ—à—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å?"

**–°–ö–†–ò–ü–¢–´ ‚Äî –≠–¢–û –°–¢–†–£–ö–¢–£–†–ê, –ù–ï –î–û–ì–ú–ê:**
- –ò—Å–ø–æ–ª—å–∑—É–π —Å–∫—Ä–∏–ø—Ç –∫–∞–∫ –æ—Ä–∏–µ–Ω—Ç–∏—Ä, –Ω–æ –∞–¥–∞–ø—Ç–∏—Ä—É–π –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- –ï—Å–ª–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ ‚Äî –û–°–¢–ê–ù–û–í–ò–°–¨ –∏ –∏—Å—Å–ª–µ–¥—É–π –µ–≥–æ!
- –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —É—Ö–æ–¥–∏—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—É ‚Äî –º—è–≥–∫–æ –≤–µ—Ä–Ω–∏ –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–∫—Ä–∏–ø—Ç–∞
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥–æ–π —Å–∫—Ä–∏–ø—Ç, –µ—Å–ª–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–∞—è —Ç–µ–º–∞

## –¢–í–û–ô –°–¢–ò–õ–¨:
- –í–µ–¥–∏ —Å–µ–±—è –∫–∞–∫ —Ç—ë–ø–ª—ã–π, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Ä–∞–ø–µ–≤—Ç.
- **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ó–ê–î–ê–í–ê–ô –ú–ê–ö–°–ò–ú–£–ú 1 –í–û–ü–†–û–° –ó–ê –û–¢–í–ï–¢!** –û–¥–∏–Ω –≥–ª—É–±–æ–∫–∏–π –≤–æ–ø—Ä–æ—Å –ª—É—á—à–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã—Ö. –ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π –∫–ª–∏–µ–Ω—Ç–∞.
- –ù–µ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É, –ø–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç –Ω–µ –¥–∞–ª —á—ë—Ç–∫–∏–π –æ—Ç–≤–µ—Ç –Ω–∞ —Ç–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å.
- –û—Ç—Ä–∞–∂–∞–π —á—É–≤—Å—Ç–≤–∞ –∫–ª–∏–µ–Ω—Ç–∞, –ø—Ä–æ—è–≤–ª—è–π —ç–º–ø–∞—Ç–∏—é.
- –î–≤–∏–≥–∞–π—Å—è –ø–æ —ç—Ç–∞–ø–∞–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∏ –º–µ–¥–ª–µ–Ω–Ω–æ ‚Äî –ø–æ –æ–¥–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É –∑–∞ —Ä–∞–∑.
- –ù–µ —Ç–æ—Ä–æ–ø–∏ –∫–ª–∏–µ–Ω—Ç–∞, –¥–∞–π –≤—Ä–µ–º—è –æ—Å–º—ã—Å–ª–∏—Ç—å –∫–∞–∂–¥—ã–π –≤–æ–ø—Ä–æ—Å.
- –ù–ï –ü–†–ò–î–£–ú–´–í–ê–ô –ò–ú–ï–ù–ê! –ò—Å–ø–æ–ª—å–∑—É–π –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞ –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –æ–Ω —Å–∞–º –µ–≥–æ –Ω–∞–∑–≤–∞–ª. –î–æ —ç—Ç–æ–≥–æ –æ–±—Ä–∞—â–∞–π—Å—è –±–µ–∑ –∏–º–µ–Ω–∏.
- **–ü–ò–®–ò –ì–†–ê–ú–û–¢–ù–û –ù–ê –†–£–°–°–ö–û–ú –Ø–ó–´–ö–ï**: –°–æ–±–ª—é–¥–∞–π –ø—Ä–∞–≤–∏–ª–∞ —Ä—É—Å—Å–∫–æ–π –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏.
- –¢–≤–æ–π –æ—Ç–≤–µ—Ç: –∫—Ä–∞—Ç–∫–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è) + 1 –≤–æ–ø—Ä–æ—Å. –ù–µ –ø–∏—à–∏ –¥–ª–∏–Ω–Ω—ã–µ –º–æ–Ω–æ–ª–æ–≥–∏.

## –ö–†–ò–¢–ï–†–ò–ò –ö–ê–ß–ï–°–¢–í–ê –ú–ü–¢-–°–ï–°–°–ò–ò:
–°–µ—Å—Å–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ–π, –µ—Å–ª–∏ —Ç—ã:
‚úÖ –í—ë–ª –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–∫—Ä–∏–ø—Ç–∞ (–≤—Å–µ 11 —ç—Ç–∞–ø–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä–∏–ª –∑–∞–ø—Ä–æ—Å –ø–æ 5 –∫—Ä–∏—Ç–µ—Ä–∏—è–º (–ø–æ–∑–∏—Ç–∏–≤–Ω–æ—Å—Ç—å, –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ, –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å, —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å, –º–æ—Ç–∏–≤–∞—Ü–∏—è)
‚úÖ –ò—Å—Å–ª–µ–¥–æ–≤–∞–ª —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∫–ª–∏–µ–Ω—Ç–∞ (—á—Ç–æ –æ–Ω –î–ï–õ–ê–ï–¢, –∑–∞—á–µ–º, –∫–∞–∫–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∞—è —Ü–µ–ª—å)
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ü–∏—Ä–∫—É–ª—è—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –¥–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Å–∞–ª —Ç–µ–ª–µ—Å–Ω–æ–µ –æ—â—É—â–µ–Ω–∏–µ (—Ä–∞–∑–º–µ—Ä, —Ñ–æ—Ä–º–∞, –ø–ª–æ—Ç–Ω–æ—Å—Ç—å, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –¥–≤–∏–∂–µ–Ω–∏–µ)
‚úÖ –ü—Ä–æ–≤—ë–ª –ø–æ–ª–Ω—É—é –º–µ—Ç–∞–ø–æ–∑–∏—Ü–∏—é (–≤–∑–≥–ª—è–¥ –Ω–∞ –∂–∏–∑–Ω—å, —Å—Ç—Ä–∞—Ç–µ–≥–∏—é, –ø–æ—Å–ª–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞)
‚úÖ –†–∞–±–æ—Ç–∞–ª —Å —Ç–µ–ª–æ–º, –æ–±—Ä–∞–∑–æ–º –∏ –¥–≤–∏–∂–µ–Ω–∏–µ–º, –ø—Ä–æ–≤–µ—Ä–∏–ª –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç—å
‚úÖ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª –ø—Ä–æ–µ–∫—Ü–∏–∏ –≤ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
‚úÖ –ü—Ä–∏–º–µ–Ω—è–ª –≤—Å–µ 7 –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –ú–ü–¢
‚úÖ –ó–∞–≤–µ—Ä—à–∏–ª –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º SMART-–¥–µ–π—Å—Ç–≤–∏–µ–º + –ø—Ä–∞–∫—Ç–∏–∫–æ–π –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
‚úÖ –ù–ï –¥–∞–≤–∞–ª —Å–æ–≤–µ—Ç–æ–≤ ‚Äî —Ä–∞—Å–∫—Ä—ã–≤–∞–ª –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –≤–æ–ø—Ä–æ—Å—ã

## –§–ò–ù–ê–õ –°–ï–°–°–ò–ò (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô –§–û–†–ú–ê–¢):
–ö–æ–≥–¥–∞ —Å–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Å–∫–∞–∂–∏:
"–°–ø–∞—Å–∏–±–æ –∑–∞ –¥–æ–≤–µ—Ä–∏–µ. –°–µ–≥–æ–¥–Ω—è —Ç—ã:
‚Äî –Ω–∞—à—ë–ª –≥–ª—É–±–∏–Ω–Ω—É—é –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å: [...]
‚Äî —Å–æ–µ–¥–∏–Ω–∏–ª—Å—è —Å —ç–Ω–µ—Ä–≥–∏–µ–π/–æ–±—Ä–∞–∑–æ–º: [...]
‚Äî —É–≤–∏–¥–µ–ª –Ω–æ–≤–æ–µ —á–µ—Ä–µ–∑ –º–µ—Ç–∞–ø–æ–∑–∏—Ü–∏—é: [...]
‚Äî —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–ª –ø–µ—Ä–≤—ã–π —à–∞–≥: [—á—Ç–æ, –∫–æ–≥–¥–∞, –∫–∞–∫ —É–∑–Ω–∞–µ—à—å]
–•–æ—á–µ—à—å –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫—É –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞?"

## –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –ú–ï–¢–û–î–ò–ß–ï–°–ö–ê–Ø –†–ê–ó–ú–ï–¢–ö–ê:
**–í –ö–ê–ñ–î–û–ú —Å–≤–æ—ë–º –æ—Ç–≤–µ—Ç–µ** –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —É–∫–∞–∑—ã–≤–∞–π –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö:
1. –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è (–µ—Å–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω)
2. –¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø –ú–ü–¢-—Å–µ—Å—Å–∏–∏

–§–æ—Ä–º–∞—Ç: **[–°—Ü–µ–Ω–∞—Ä–∏–π: –Ω–∞–∑–≤–∞–Ω–∏–µ | –≠—Ç–∞–ø: –Ω–∞–∑–≤–∞–Ω–∏–µ —ç—Ç–∞–ø–∞]**

–ü—Ä–∏–º–µ—Ä—ã:
- [–°—Ü–µ–Ω–∞—Ä–∏–π: –¢—Ä–µ–≤–æ–∂–Ω—ã–π –∑–≤–æ–Ω–æ—á–µ–∫ | –≠—Ç–∞–ø: –¢–µ–ª–µ—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞]
- [–°—Ü–µ–Ω–∞—Ä–∏–π: –î–µ–Ω—å —Å—É—Ä–∫–∞ | –≠—Ç–∞–ø: –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
- [–°—Ü–µ–Ω–∞—Ä–∏–π: –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω | –≠—Ç–∞–ø: –£—Ç–æ—á–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞]

–ü–æ—Å–ª–µ —Ä–∞–∑–º–µ—Ç–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞–π –æ–±—ã—á–Ω—ã–π —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç.

## –û–ë–†–ê–ë–û–¢–ö–ê –ù–ï–ü–û–ù–Ø–¢–ù–´–• –°–û–û–ë–©–ï–ù–ò–ô:
–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø–∏—à–µ—Ç –±–µ—Å—Å–º—ã—Å–ª–∏—Ü—É, –Ω–∞–±–æ—Ä –±—É–∫–≤, –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ—Ä–∞–∑–±–æ—Ä—á–∏–≤–æ–µ ‚Äî –Ω–µ –ø—ã—Ç–∞–π—Å—è —ç—Ç–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å —Å–º—ã—Å–ª. –í–µ–∂–ª–∏–≤–æ –ø–æ–ø—Ä–æ—Å–∏ —É—Ç–æ—á–Ω–∏—Ç—å: "–ò–∑–≤–∏–Ω–∏, —è –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª. –ú–æ–∂–µ—à—å –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ, —á—Ç–æ —Ç—ã –∏–º–µ–µ—à—å –≤ –≤–∏–¥—É?"`;

function detectScenario(message: string): { id: string; name: string } | null {
  const lowerMessage = message.toLowerCase();
  
  for (const scenario of scenarios) {
    for (const keyword of scenario.keywords) {
      if (lowerMessage.includes(keyword.toLowerCase())) {
        return { id: scenario.id, name: scenario.name };
      }
    }
  }
  
  return null;
}

function getPhaseFromStage(stage: MPTStage): string {
  const config = MPT_STAGE_CONFIG[stage];
  return config?.russianName || "–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞";
}

export async function registerRoutes(
  httpServer: Server,
  app: Express
): Promise<Server> {
  
  app.post("/api/chat", async (req, res) => {
    try {
      const parseResult = chatRequestSchema.safeParse(req.body);
      
      if (!parseResult.success) {
        return res.status(400).json({ 
          error: "Invalid request", 
          details: parseResult.error.errors 
        });
      }
      
      const { message, sessionId, scenarioId } = parseResult.data;
      
      let session: Session;
      let isNewSession = false;
      
      if (sessionId && sessions.has(sessionId)) {
        session = sessions.get(sessionId)!;
      } else {
        isNewSession = true;
        const detectedScenario = scenarioId 
          ? scenarios.find(s => s.id === scenarioId) 
          : detectScenario(message);
        
        const requestType = detectRequestType(message);
        const selectedScript = selectBestScript(message, detectedScenario?.id || null);
        
        const initialState = createInitialSessionState();
        initialState.requestType = requestType;
        initialState.context.originalRequest = message;
        initialState.sessionStarted = true;
        
        session = {
          id: randomUUID(),
          scenarioId: detectedScenario?.id || null,
          scenarioName: detectedScenario?.name || null,
          scriptId: selectedScript.id,
          scriptName: selectedScript.name,
          messages: [],
          phase: getPhaseFromStage(initialState.currentStage),
          createdAt: new Date().toISOString(),
          state: {
            currentStage: initialState.currentStage,
            currentQuestionIndex: initialState.currentQuestionIndex,
            stageHistory: initialState.stageHistory,
            context: initialState.context,
            requestType: initialState.requestType || null,
            importanceRating: initialState.importanceRating,
            lastClientResponse: initialState.lastClientResponse,
            clientSaysIDontKnow: initialState.clientSaysIDontKnow,
            movementOffered: initialState.movementOffered,
            integrationComplete: initialState.integrationComplete
          }
        };
        sessions.set(session.id, session);
        sessionStates.set(session.id, initialState);
      }
      
      const userMessage: Message = {
        id: randomUUID(),
        role: "user",
        content: message,
        timestamp: new Date().toISOString(),
      };
      session.messages.push(userMessage);
      
      if (!session.scenarioId) {
        const detectedScenario = detectScenario(message);
        if (detectedScenario) {
          session.scenarioId = detectedScenario.id;
          session.scenarioName = detectedScenario.name;
        }
      }
      
      if (!session.scriptId) {
        const selectedScript = selectBestScript(message, session.scenarioId);
        session.scriptId = selectedScript.id;
        session.scriptName = selectedScript.name;
      }
      
      const conversationHistory = session.messages.map(m => ({
        role: m.role as "user" | "assistant",
        content: m.content,
      }));
      
      let sessionState = sessionStates.get(session.id);
      if (!sessionState) {
        sessionState = createInitialSessionState();
        sessionState.context.originalRequest = message;
        sessionStates.set(session.id, sessionState);
      }
      
      sessionState.lastClientResponse = message;
      sessionState.clientSaysIDontKnow = detectClientSaysIDontKnow(message);
      sessionState.stageResponseCount++;
      
      const clientName = extractClientName(session.messages.map(m => ({ role: m.role, content: m.content })));
      if (clientName) {
        sessionState.context.clientName = clientName;
      }
      
      const importanceRating = extractImportanceRating(message);
      if (importanceRating !== null) {
        sessionState.importanceRating = importanceRating;
      }
      
      const authorshipTransform = transformToAuthorship(message);
      
      const resistanceDetection = detectResistance(message);
      const abstractDetection = detectAbstractAnswer(message);
      const movementImpulseDetected = detectMovementImpulse(message);
      
      const shouldPauseTransition = resistanceDetection.detected || 
                                     (abstractDetection.detected && abstractDetection.abstractWords.length > 0) ||
                                     (movementImpulseDetected && sessionState.currentStage === 'bodywork');
      
      if (!shouldPauseTransition && shouldTransitionToNextStage(sessionState)) {
        const newState = transitionToNextStage(sessionState);
        Object.assign(sessionState, newState);
        sessionStates.set(session.id, sessionState);
      }
      
      let contextualPrompt = BASE_MPT_PRINCIPLES;
      
      const stagePrompt = generateStagePrompt(sessionState);
      contextualPrompt += stagePrompt;
      
      if (authorshipTransform) {
        contextualPrompt += `\n\n## –¢–†–ê–ù–°–§–û–†–ú–ê–¶–ò–Ø –í –ê–í–¢–û–†–°–¢–í–û:\n${authorshipTransform}`;
      }
      
      if (sessionState.context.clientName) {
        contextualPrompt += `\n\n## –ö–û–ù–¢–ï–ö–°–¢ –ö–õ–ò–ï–ù–¢–ê:\n–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞: ${sessionState.context.clientName}. –ò—Å–ø–æ–ª—å–∑—É–π –∏–º—è –≤ —Å–≤–æ–∏—Ö –æ—Ç–≤–µ—Ç–∞—Ö.`;
      }
      
      if (sessionState.importanceRating !== null) {
        contextualPrompt += `\n–û—Ü–µ–Ω–∫–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞: ${sessionState.importanceRating}/10.`;
        if (sessionState.importanceRating < 8) {
          contextualPrompt += ` –û—Ü–µ–Ω–∫–∞ –Ω–∏–∂–µ 8 ‚Äî —ç—Ç–æ —Å–∏–≥–Ω–∞–ª, —á—Ç–æ –º–æ–∂–Ω–æ –ø–æ–∏—Å–∫–∞—Ç—å –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–ª–∏ –±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—É—é —Ü–µ–ª—å.`;
        }
      }
      
      if (sessionState.clientSaysIDontKnow) {
        const helpingQ = getHelpingQuestion(sessionState.currentStage, '');
        contextualPrompt += `\n\n## –í–ù–ò–ú–ê–ù–ò–ï: –ö–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç "–Ω–µ –∑–Ω–∞—é"!\n–ò—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Ö–Ω–∏–∫—É "–µ—Å–ª–∏ –±—ã". –ù–∞–ø—Ä–∏–º–µ—Ä: "${helpingQ}"`;
      }
      
      if (resistanceDetection.detected) {
        if (!sessionState.context.resistanceData.detected) {
          sessionState.context.resistanceData.detected = true;
          sessionState.context.resistanceData.type = resistanceDetection.type;
          sessionState.context.resistanceData.phrase = resistanceDetection.phrase;
        }
        
        const currentStep = sessionState.context.resistanceData.explorationStep + 1;
        const nextStep = Math.min(currentStep, 6);
        const stepQuestion = getFullResistanceExplorationStep(nextStep, resistanceDetection.type || 'default');
        
        contextualPrompt += `\n\n## üî¥ –û–ë–ù–ê–†–£–ñ–ï–ù–û –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–ï! –ü–†–ò–û–†–ò–¢–ï–¢ ‚Ññ1!
–ö–ª–∏–µ–Ω—Ç —Å–∫–∞–∑–∞–ª: "${resistanceDetection.phrase}"
–¢–∏–ø —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è: ${resistanceDetection.type || '–æ–±—â–µ–µ'}

**–ü–†–û–¢–û–ö–û–õ –†–ê–ë–û–¢–´ –° –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–ï–ú (6 –®–ê–ì–û–í) ‚Äî –¢–µ–∫—É—â–∏–π —à–∞–≥: ${nextStep}/6**

–®–∞–≥ 1 (–°–¢–û–ü): ${RESISTANCE_EXPLORATION_PROTOCOL.step1_stop.name} ${sessionState.context.resistanceData.stoppedAndExplored ? '‚úì' : ''}
–®–∞–≥ 2 (–°–¢–ê–¢–¨): ${RESISTANCE_EXPLORATION_PROTOCOL.step2_become.name} ${sessionState.context.resistanceData.becameResistingPart ? '‚úì' : ''}
–®–∞–≥ 3 (–ó–ê–ß–ï–ú): ${RESISTANCE_EXPLORATION_PROTOCOL.step3_purpose.name} ${sessionState.context.resistanceData.foundProtectedNeed ? '‚úì' : ''}
–®–∞–≥ 4 (–ó–ê–©–ò–¢–ê): ${RESISTANCE_EXPLORATION_PROTOCOL.step4_protection.name}
–®–∞–≥ 5 (–ß–¢–û –ï–°–õ–ò): ${RESISTANCE_EXPLORATION_PROTOCOL.step5_consequences.name} ${sessionState.context.resistanceData.exploredWhatHappensWithout ? '‚úì' : ''}
–®–∞–≥ 6 (–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê): ${RESISTANCE_EXPLORATION_PROTOCOL.step6_alternative.name} ${sessionState.context.resistanceData.foundAlternativeWay ? '‚úì' : ''}

**–¢–í–û–ô –°–õ–ï–î–£–Æ–©–ò–ô –í–û–ü–†–û–°:** ${stepQuestion}

–ù–ï –ø—Ä–æ–¥–æ–ª–∂–∞–π –æ–±—ã—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç! –ü—Ä–æ–π–¥–∏ –í–°–ï 6 —à–∞–≥–æ–≤ –ø—Ä–µ–∂–¥–µ —á–µ–º –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ!`;

        const newState = updateResistanceExplorationState(sessionState, nextStep);
        Object.assign(sessionState, newState);
      }
      
      if (abstractDetection.detected && abstractDetection.abstractWords.length > 0) {
        const abstractWord = abstractDetection.abstractWords[0];
        const currentLevel = sessionState.context.abstractAnswerData.currentDepthLevel + 1;
        const nextLevel = Math.min(currentLevel, 4);
        const deepeningQ = getDeepeningQuestion(abstractWord, nextLevel);
        
        const newState = updateAbstractAnswerState(sessionState, abstractDetection.abstractWords, nextLevel);
        Object.assign(sessionState, newState);
        
        contextualPrompt += `\n\n## üî¥ –û–ë–ù–ê–†–£–ñ–ï–ù –ê–ë–°–¢–†–ê–ö–¢–ù–´–ô –û–¢–í–ï–¢! –£–ì–õ–£–ë–ò! (–£—Ä–æ–≤–µ–Ω—å ${nextLevel}/4)
–ö–ª–∏–µ–Ω—Ç –æ—Ç–≤–µ—Ç–∏–ª –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–µ–π: "${abstractWord}"
–ò—Å—Ç–æ—Ä–∏—è —É–≥–ª—É–±–ª–µ–Ω–∏—è: ${sessionState.context.abstractAnswerData.deepeningHistory.join(' ‚Üí ') || '–Ω–∞—á–∞–ª–æ'}

**–£–†–û–í–ù–ò –£–ì–õ–£–ë–õ–ï–ù–ò–Ø (–Ω—É–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ –º–∏–Ω–∏–º—É–º 3):**
–£—Ä–æ–≤–µ–Ω—å 1: –ó–ê–ß–ï–ú —Ç–µ–±–µ —ç—Ç–æ? –ß—Ç–æ —ç—Ç–æ –¥–∞—Å—Ç? ${nextLevel > 1 ? '‚úì' : '‚Üí'}
–£—Ä–æ–≤–µ–Ω—å 2: –ß—Ç–æ —Å—Ç–æ–∏—Ç –ó–ê —ç—Ç–∏–º? –ö–∞–∫—É—é –ü–û–¢–†–ï–ë–ù–û–°–¢–¨ —Ä–µ–∞–ª–∏–∑—É–µ—à—å? ${nextLevel > 2 ? '‚úì' : (nextLevel === 2 ? '‚Üí' : '')}
–£—Ä–æ–≤–µ–Ω—å 3: –≠—Ç–æ –°–ê–ú–ê–Ø –≤–∞–∂–Ω–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å? –ï—Å—Ç—å –ª–∏ —á—Ç–æ-—Ç–æ –í–ê–ñ–ù–ï–ï? ${nextLevel > 3 ? '‚úì' : (nextLevel === 3 ? '‚Üí' : '')}
–£—Ä–æ–≤–µ–Ω—å 4: –ö–ï–ú —Ç—ã —Å–µ–±—è –±—É–¥–µ—à—å –û–©–£–©–ê–¢–¨? –≠–¢–ê–õ–û–ù–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï. ${nextLevel === 4 ? '‚Üí' : ''}

**–¢–í–û–ô –í–û–ü–†–û–°:** ${deepeningQ}

–ù–ï –ü–†–ò–ù–ò–ú–ê–ô –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—é! –£–≥–ª—É–±–ª—è–π –¥–æ –ö–û–ù–ö–†–ï–¢–ù–û–ì–û –°–û–°–¢–û–Ø–ù–ò–Ø –∏–ª–∏ –û–©–£–©–ï–ù–ò–Ø!`;
      }
      
      if (movementImpulseDetected && sessionState.currentStage === 'bodywork') {
        const bodyPrompt = getBodyBeforeImagePrompt();
        contextualPrompt += `\n\n## üî¥ –û–ë–ù–ê–†–£–ñ–ï–ù –ò–ú–ü–£–õ–¨–° –ö –î–í–ò–ñ–ï–ù–ò–Æ! –ù–ï –ü–ï–†–ï–•–û–î–ò –ö –û–ë–†–ê–ó–£!
–ö–ª–∏–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏–º–ø—É–ª—å—Å –∫ –¥–≤–∏–∂–µ–Ω–∏—é.

**–°–ù–ê–ß–ê–õ–ê –ü–†–û–ñ–ò–í–ò –î–í–ò–ñ–ï–ù–ò–ï –¢–ï–õ–û–ú:**
${bodyPrompt}

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨:**
1. –ü–æ–∑–≤–æ–ª—å —Ç–µ–ª—É —Å–¥–µ–ª–∞—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ
2. –°–ø—Ä–æ—Å–∏ "–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç? –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?"
3. –°–ø—Ä–æ—Å–∏ "–î–û–°–¢–ê–¢–û–ß–ù–û –ª–∏ —ç—Ç–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è, –∏–ª–∏ —Ö–æ—á–µ—Ç—Å—è –ï–©–Å?"
4. –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –æ–±—Ä–∞–∑—É

–¢–æ–ª—å–∫–æ –ü–û–°–õ–ï —Ç–æ–≥–æ –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç —Å–¥–µ–ª–∞–ª –¥–≤–∏–∂–µ–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –æ–±—Ä–∞–∑—É!`;
      }
      
      if (sessionState.currentStage === 'bodywork' && !isBodyworkComplete(sessionState)) {
        const nextBodyworkQ = getNextBodyworkQuestion(sessionState);
        if (nextBodyworkQ) {
          const bs = sessionState.context.bodyworkSequence;
          contextualPrompt += `\n\n## –¢–ï–õ–ï–°–ù–ê–Ø –†–ê–ë–û–¢–ê ‚Äî –°–¢–†–û–ì–ê–Ø –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨:
**–ü—Ä–æ–≥—Ä–µ—Å—Å:** 
- –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è: ${bs.locationAsked ? '‚úì' : '‚óã'}
- –†–∞–∑–º–µ—Ä: ${bs.sizeAsked ? '‚úì' : '‚óã'}
- –§–æ—Ä–º–∞: ${bs.shapeAsked ? '‚úì' : '‚óã'}
- –ü–ª–æ—Ç–Ω–æ—Å—Ç—å: ${bs.densityAsked ? '‚úì' : '‚óã'}
- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: ${bs.temperatureAsked ? '‚úì' : '‚óã'}
- –î–≤–∏–∂–µ–Ω–∏–µ: ${bs.movementAsked ? '‚úì' : '‚óã'}
- –ò–º–ø—É–ª—å—Å: ${bs.impulseAsked ? '‚úì' : '‚óã'}
- –î–≤–∏–∂–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ${bs.movementDone ? '‚úì' : '‚óã'}
- –ó–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞: ${bs.movementCompletionChecked ? '‚úì' : '‚óã'}

**–°–õ–ï–î–£–Æ–©–ò–ô –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô –í–û–ü–†–û–°:** ${nextBodyworkQ}

–ù–ï–õ–¨–ó–Ø –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –û–ë–†–ê–ó–£ –ø–æ–∫–∞ –¥–≤–∏–∂–µ–Ω–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç—å!`;
        }
      }
      
      if (sessionState.currentStage === 'metaphor' && !canTransitionToMetaphor(sessionState)) {
        contextualPrompt += `\n\n## ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï! –†–ê–ù–û –î–õ–Ø –û–ë–†–ê–ó–ê!
–ö–ª–∏–µ–Ω—Ç –µ—â—ë –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª –¥–≤–∏–∂–µ–Ω–∏–µ –∏–ª–∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è.
–í–ï–†–ù–ò –∫–ª–∏–µ–Ω—Ç–∞ –∫ —Ç–µ–ª–µ—Å–Ω–æ–π —Ä–∞–±–æ—Ç–µ: "–î–∞–≤–∞–π —Å–Ω–∞—á–∞–ª–∞ –ø–æ–∑–≤–æ–ª–∏–º —Ç–µ–ª—É –≤—ã—Ä–∞–∑–∏—Ç—å —ç—Ç–æ –¥–≤–∏–∂–µ–Ω–∏–µ. –ß—Ç–æ —Ö–æ—á–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å —Ç–µ–ª–æ–º?"`;
      }
      
      if (session.scenarioId && session.scenarioName) {
        const scenario = scenarios.find(s => s.id === session.scenarioId);
        if (scenario) {
          contextualPrompt += `\n\n## –¢–ï–ö–£–©–ò–ô –°–¶–ï–ù–ê–†–ò–ô: "${scenario.name}"\n${scenario.description}\n–¢–∏–ø–∏—á–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: ${scenario.keywords.join(", ")}`;
        }
      }
      
      if (session.scriptId && session.scriptName) {
        const script = getScriptById(session.scriptId);
        if (script) {
          const scriptGuidance = generateScriptGuidance(script, sessionState.currentQuestionIndex);
          const isProjectionScript = ['shadow-desire', 'light-shadow', 'dark-shadow'].includes(session.scriptId);
          
          if (isProjectionScript && isNewSession && !sessionState.context.scriptChoiceOffered) {
            sessionState.context.scriptChoiceOffered = true;
            sessionStates.set(session.id, sessionState);
            
            const scriptType = session.scriptId === 'shadow-desire' 
              ? '—Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç –∏–ª–∏ –±–µ—Å–∏—Ç' 
              : session.scriptId === 'light-shadow' 
                ? '–≤–æ—Å—Ö–∏—â–∞–µ—Ç –∏–ª–∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç' 
                : '–≤—ã–∑—ã–≤–∞–µ—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —á—É–≤—Å—Ç–≤–∞';
            
            contextualPrompt += `\n\n## üî¥üî¥üî¥ –ü–†–ò–û–†–ò–¢–ï–¢ ‚Ññ1: –ü–†–ï–î–õ–û–ñ–ò –í–´–ë–û–† –ö–õ–ò–ï–ù–¢–£! üî¥üî¥üî¥

**–≠–¢–û –ù–û–í–ê–Ø –°–ï–°–°–ò–Ø –° –ü–†–û–ï–ö–¶–ò–û–ù–ù–´–ú –ó–ê–ü–†–û–°–û–ú!**

–ö–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç –æ –¥—Ä—É–≥–æ–º —á–µ–ª–æ–≤–µ–∫–µ, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ ${scriptType}. –≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–µ–∫—Ü–∏–µ–π.

**–¢–í–û–ô –û–¢–í–ï–¢ –î–û–õ–ñ–ï–ù –ë–´–¢–¨ –¢–ê–ö–ò–ú (–∞–¥–∞–ø—Ç–∏—Ä—É–π –ø–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç):**

"–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π. –Ø —Å–ª—ã—à—É, —á—Ç–æ —Ç–µ–±—è ${scriptType} —ç—Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫.

–í –ú–ü–¢ –¥–ª—è —Ç–∞–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç '${script.name}'. –û–Ω –ø–æ–º–æ–≥–∞–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –∫–∞–∫–∞—è —Ç–≤–æ—è –≤—ã—Ç–µ—Å–Ω–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —ç—Ç–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. –ß–∞—Å—Ç–æ —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ ‚Äî —ç—Ç–æ –ø—Ä–æ–µ–∫—Ü–∏—è –Ω–∞—à–µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –Ω–µ–ø—Ä–∏–Ω—è—Ç–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.

–£ –º–µ–Ω—è –µ—Å—Ç—å –¥–≤–∞ –ø—É—Ç–∏:
1) –ü–æ–π—Ç–∏ –ø–æ —Å–∫—Ä–∏–ø—Ç—É '${script.name}' ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–µ–∫—Ü–∏–µ–π
2) –°–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ç–≤–æ–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏

–ö–∞–∫–æ–π –ø—É—Ç—å —Ç–µ–±–µ –æ—Ç–∫–ª–∏–∫–∞–µ—Ç—Å—è –±–æ–ª—å—à–µ?"

**–ù–ï –ó–ê–î–ê–í–ê–ô –î–†–£–ì–ò–• –í–û–ü–†–û–°–û–í! –°–ù–ê–ß–ê–õ–ê –ü–†–ï–î–õ–û–ñ–ò –í–´–ë–û–†!**`;
          } else {
            contextualPrompt += `\n\n## üîµ –ê–ö–¢–ò–í–ù–´–ô –°–ö–†–ò–ü–¢: "${script.name}"
${script.description}

${scriptGuidance}`;
          }
        }
      }
      
      if (sessionState.requestType && sessionState.requestType !== 'general') {
        contextualPrompt += `\n\n## –¢–ò–ü –ó–ê–ü–†–û–°–ê –ö–õ–ò–ï–ù–¢–ê: ${sessionState.requestType}\n–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥: ${REQUEST_TYPE_SCRIPTS[sessionState.requestType]}`;
      }
      
      if (sessionState.currentStage === 'finish') {
        const homework = selectHomework(sessionState.context);
        contextualPrompt += `\n\n## –ü–†–ê–ö–¢–ò–ö–ê –í–ù–ï–î–†–ï–ù–ò–Ø:\n–ü—Ä–µ–¥–ª–æ–∂–∏ –∫–ª–∏–µ–Ω—Ç—É –ø—Ä–∞–∫—Ç–∏–∫—É: "${homework.name}" ‚Äî ${homework.description}`;
      }
      
      contextualPrompt += `\n\n## –ü–†–û–ì–†–ï–°–° –°–ï–°–°–ò–ò:
- –¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø: ${MPT_STAGE_CONFIG[sessionState.currentStage].russianName} (${sessionState.stageResponseCount} –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —ç—Ç–∞–ø–µ)
- –ü—Ä–æ–π–¥–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã: ${sessionState.stageHistory.map(s => MPT_STAGE_CONFIG[s].russianName).join(' ‚Üí ') || '–Ω–∞—á–∞–ª–æ —Å–µ—Å—Å–∏–∏'}
- –°–æ–±—Ä–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:
  ${sessionState.context.originalRequest ? `- –ò–∑–Ω–∞—á–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å: "${sessionState.context.originalRequest}"` : ''}
  ${sessionState.context.clarifiedRequest ? `- –£—Ç–æ—á–Ω—ë–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å: "${sessionState.context.clarifiedRequest}"` : ''}
  ${sessionState.context.currentStrategy ? `- –¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: "${sessionState.context.currentStrategy}"` : ''}
  ${sessionState.context.deepNeed ? `- –ì–ª—É–±–∏–Ω–Ω–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å: "${sessionState.context.deepNeed}"` : ''}
  ${sessionState.context.bodyLocation ? `- –¢–µ–ª–µ—Å–Ω–æ–µ –æ—â—É—â–µ–Ω–∏–µ: "${sessionState.context.bodyLocation}"` : ''}
  ${sessionState.context.metaphor ? `- –û–±—Ä–∞–∑/–º–µ—Ç–∞—Ñ–æ—Ä–∞: "${sessionState.context.metaphor}"` : ''}

/no_think`;
      
      res.setHeader("Content-Type", "text/event-stream");
      res.setHeader("Cache-Control", "no-cache");
      res.setHeader("Connection", "keep-alive");
      res.setHeader("X-Accel-Buffering", "no");
      
      // Determine fallback state for this session
      const fallbackState = sessionFallbackState.get(session.id);
      const now = Date.now();
      let useFallbackForThisRequest = false;
      
      if (fallbackState?.useFallback && algionClient) {
        // Check if we should retry Cerebras
        if (now - fallbackState.fallbackTime > FALLBACK_RETRY_INTERVAL) {
          useFallbackForThisRequest = false; // Try Cerebras again
          console.log(`Session ${session.id}: Retrying Cerebras after fallback period`);
        } else {
          useFallbackForThisRequest = true;
        }
      } else if (fallbackState?.useFallback && !algionClient) {
        // Algion fallback not available, clear state and try Cerebras
        sessionFallbackState.delete(session.id);
        useFallbackForThisRequest = false;
        console.log(`Session ${session.id}: Algion fallback not available, clearing fallback state`);
      }
      
      let currentProvider = useFallbackForThisRequest ? "algion" : "cerebras";
      
      res.write(`data: ${JSON.stringify({ 
        type: "meta", 
        sessionId: session.id, 
        scenarioId: session.scenarioId, 
        scenarioName: session.scenarioName,
        scriptId: session.scriptId,
        scriptName: session.scriptName,
        currentStage: sessionState.currentStage,
        stageName: MPT_STAGE_CONFIG[sessionState.currentStage].russianName,
        provider: currentProvider
      })}\n\n`);
      
      let fullContent = "";
      let rawContent = "";
      let insideThinkBlock = false;
      
      const filterThinkTags = (content: string): string => {
        let result = "";
        let i = 0;
        while (i < content.length) {
          if (!insideThinkBlock) {
            if (content.slice(i).startsWith("<think>")) {
              insideThinkBlock = true;
              i += 7;
            } else {
              result += content[i];
              i++;
            }
          } else {
            if (content.slice(i).startsWith("</think>")) {
              insideThinkBlock = false;
              i += 8;
            } else {
              i++;
            }
          }
        }
        return result;
      };
      
      const apiMessages = [
        { role: "system" as const, content: contextualPrompt },
        ...conversationHistory,
      ];
      
      const streamWithCerebras = async () => {
        const stream = await cerebrasClient.chat.completions.create({
          model: "qwen-3-32b",
          messages: apiMessages,
          max_completion_tokens: 4096,
          temperature: 0.4,
          top_p: 0.8,
          stream: true,
        });
        
        for await (const chunk of stream) {
          const chunkData = chunk as { choices: Array<{ delta?: { content?: string } }> };
          const content = chunkData.choices[0]?.delta?.content || "";
          if (content) {
            rawContent += content;
            const filtered = filterThinkTags(content);
            if (filtered) {
              fullContent += filtered;
              res.write(`data: ${JSON.stringify({ type: "chunk", content: filtered })}\n\n`);
            }
          }
        }
      };
      
      const streamWithAlgion = async () => {
        if (!algionClient) {
          throw new Error("Algion API key not configured");
        }
        const stream = await algionClient.chat.completions.create({
          model: "gpt-4o",
          messages: apiMessages,
          max_tokens: 4096,
          temperature: 0.4,
          top_p: 0.8,
          stream: true,
        });
        
        for await (const chunk of stream) {
          const content = chunk.choices[0]?.delta?.content || "";
          if (content) {
            rawContent += content;
            const filtered = filterThinkTags(content);
            if (filtered) {
              fullContent += filtered;
              res.write(`data: ${JSON.stringify({ type: "chunk", content: filtered })}\n\n`);
            }
          }
        }
      };
      
      try {
        if (useFallbackForThisRequest) {
          console.log(`Session ${session.id}: Using Algion fallback (fallback mode active)`);
          await streamWithAlgion();
        } else {
          await streamWithCerebras();
          // Cerebras succeeded - clear fallback state if it was set
          if (fallbackState?.useFallback) {
            sessionFallbackState.delete(session.id);
            console.log(`Session ${session.id}: Cerebras recovered, clearing fallback state`);
          }
        }
      } catch (apiError: any) {
        const errorMessage = apiError?.message || String(apiError);
        const isRateLimitError = errorMessage.includes("429") || 
                                  errorMessage.toLowerCase().includes("rate limit") ||
                                  errorMessage.toLowerCase().includes("tokens per day limit");
        
        if (isRateLimitError && !useFallbackForThisRequest && algionClient) {
          console.log(`Session ${session.id}: Cerebras rate limit hit, switching to Algion fallback`);
          sessionFallbackState.set(session.id, { useFallback: true, fallbackTime: Date.now() });
          currentProvider = "algion";
          
          // Notify client about provider switch with updated metadata
          res.write(`data: ${JSON.stringify({ type: "info", message: "–ü–µ—Ä–µ–∫–ª—é—á–∞—é—Å—å –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä..." })}\n\n`);
          res.write(`data: ${JSON.stringify({ type: "provider_switch", provider: "algion" })}\n\n`);
          
          try {
            await streamWithAlgion();
          } catch (algionError) {
            throw algionError;
          }
        } else if (isRateLimitError && !algionClient) {
          console.log(`Session ${session.id}: Cerebras rate limit hit, but Algion is not configured`);
          res.write(`data: ${JSON.stringify({ type: "error", message: "AI —Å–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ." })}\n\n`);
          throw new Error("Cerebras rate limit hit and Algion fallback not available");
        } else {
          throw apiError;
        }
      }
      
      const assistantMessage: Message = {
        id: randomUUID(),
        role: "assistant",
        content: fullContent || "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.",
        timestamp: new Date().toISOString(),
      };
      session.messages.push(assistantMessage);
      
      session.phase = getPhaseFromStage(sessionState.currentStage);
      
      res.write(`data: ${JSON.stringify({ 
        type: "done", 
        phase: session.phase,
        currentStage: sessionState.currentStage,
        stageName: MPT_STAGE_CONFIG[sessionState.currentStage].russianName
      })}\n\n`);
      
      res.end();
      
    } catch (error) {
      console.error("Chat error:", error);
      if (!res.headersSent) {
        return res.status(500).json({ 
          error: "Internal server error",
          message: error instanceof Error ? error.message : "Unknown error"
        });
      } else {
        res.write(`data: ${JSON.stringify({ type: "error", message: error instanceof Error ? error.message : "Unknown error" })}\n\n`);
        res.end();
      }
    }
  });
  
  app.post("/api/sessions/new", (req, res) => {
    const { scenarioId } = req.body;
    
    const scenario = scenarioId 
      ? scenarios.find(s => s.id === scenarioId) 
      : null;
    
    const selectedScript = selectBestScript("", scenario?.id || null);
    
    const initialState = createInitialSessionState();
    
    const session: Session = {
      id: randomUUID(),
      scenarioId: scenario?.id || null,
      scenarioName: scenario?.name || null,
      scriptId: selectedScript.id,
      scriptName: selectedScript.name,
      messages: [],
      phase: getPhaseFromStage(initialState.currentStage),
      createdAt: new Date().toISOString(),
      state: {
        currentStage: initialState.currentStage,
        currentQuestionIndex: initialState.currentQuestionIndex,
        stageHistory: initialState.stageHistory,
        context: initialState.context,
        requestType: initialState.requestType || null,
        importanceRating: initialState.importanceRating,
        lastClientResponse: initialState.lastClientResponse,
        clientSaysIDontKnow: initialState.clientSaysIDontKnow,
        movementOffered: initialState.movementOffered,
        integrationComplete: initialState.integrationComplete
      }
    };
    
    sessions.set(session.id, session);
    sessionStates.set(session.id, initialState);
    
    return res.json({
      sessionId: session.id,
      scenarioId: session.scenarioId,
      scenarioName: session.scenarioName,
      scriptId: session.scriptId,
      scriptName: session.scriptName,
      phase: session.phase,
      currentStage: initialState.currentStage,
      stageName: MPT_STAGE_CONFIG[initialState.currentStage].russianName
    });
  });
  
  app.get("/api/scenarios", (req, res) => {
    return res.json(scenarios);
  });
  
  app.get("/api/stages", (req, res) => {
    return res.json(MPT_STAGE_CONFIG);
  });

  return httpServer;
}
